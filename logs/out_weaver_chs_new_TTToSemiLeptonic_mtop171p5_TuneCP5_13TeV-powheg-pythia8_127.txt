(weaver) [mmalucch@r217n18 weaver]$ python train.py --data-train $WORK/$USER/output_127.root  --data-test $WORK/$USER/output_127.root  --data-config data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.yaml  --network-config networks/particle_net_pf_sv.py  --model-prefix models_3/  --gpus 0,1,2,3 --batch-size 512 --start-lr 5e-3 --num-epochs 3 --optimizer ranger  --log logs/train3_chs_127.log
[2022-11-30 15:52:59,616] INFO: args:
 - ('regression_mode', False)
 - ('data_config', 'data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.yaml')
 - ('data_train', ['/m100_work/INF22_lhc_0/mmalucch/output_127.root'])
 - ('data_val', [])
 - ('data_test', ['/m100_work/INF22_lhc_0/mmalucch/output_127.root'])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', False)
 - ('fetch_step', 0.01)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', None)
 - ('tensorboard_custom_fn', None)
 - ('network_config', 'networks/particle_net_pf_sv.py')
 - ('network_option', [])
 - ('model_prefix', 'models_3/')
 - ('load_model_weights', None)
 - ('num_epochs', 3)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 512)
 - ('use_amp', False)
 - ('gpus', '0,1,2,3')
 - ('predict_gpus', '0,1,2,3')
 - ('num_workers', 1)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', 'logs/train3_chs_127.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('local_rank', None)
[2022-11-30 15:52:59,635] INFO: Running in classification mode
[2022-11-30 15:53:10,501] INFO: Using 1 files for training, range: (0, 0.8)
[2022-11-30 15:53:10,501] INFO: Using 1 files for validation, range: (0.8, 1)
[2022-11-30 15:53:10,572] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 15:53:10,572] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 15:53:10,572] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 15:53:10,572] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 15:53:10,573] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 15:53:10,573] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 15:53:10,573] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 15:53:10,573] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 15:53:10,573] INFO: label_names: ('_label_',)
[2022-11-30 15:53:10,573] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl')
[2022-11-30 15:53:10,574] INFO: monitor_variables: ()
[2022-11-30 15:53:10,574] INFO: reweight_method: flat
[2022-11-30 15:53:10,574] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 15:53:10,574] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 15:53:10,574] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 15:53:10,574] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 15:53:10,574] INFO: reweight_threshold: 15
[2022-11-30 15:53:10,574] INFO: reweight_discard_under_overflow: True
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.86s/it]
[2022-11-30 15:53:15,624] INFO: Using 656612 events to make weights
[2022-11-30 15:53:15,639] INFO: label_catB:
 [[ 153  218  297  433  482  505  494  460  483  482  445  280  251  145]
 [ 251  290  429  572  699  759  705  765  647  688  583  374  328  236]
 [ 318  466  608  966 1179 1300 1351 1324 1384 1195  894  617  428  310]
 [ 292  447  704 1127 1555 1779 1861 1919 1752 1512 1167  727  424  273]
 [ 218  458  775 1361 1934 2398 2631 2672 2460 1979 1357  857  382  232]
 [ 136  300  677 1284 1828 2509 2794 2665 2473 1902 1259  688  270  142]
 [  69  211  502  918 1616 2145 2438 2482 2118 1497  978  493  184   72]
 [  25   99  232  579  905 1366 1572 1561 1402  889  544  257   92   20]
 [   5   28   73  209  359  587  749  732  585  343  236   81   25    5]
 [   1    7   18   80  115  249  273  284  216  119   73   18    9    0]
 [   0    1    5   27   40   75  108  122   84   42   21    9    1    0]
 [   0    0    0    2   22   24   26   46   22   24    6    0    0    0]
 [   0    0    0    2    5   10   11   12    7    2    3    0    0    0]
 [   0    0    0    0    0    9    8    4    5    1    0    0    0    0]
 [   0    0    0    0    0    0    0    1    0    0    1    0    0    0]]
[2022-11-30 15:53:15,646] INFO: label_catC:
 [[156 199 199 271 296 315 367 346 349 316 244 214 200 153]
 [200 176 201 276 337 358 420 358 406 341 273 192 201 200]
 [213 202 233 369 491 535 533 593 513 465 374 224 177 218]
 [131 150 227 386 467 572 654 646 566 494 335 242 143 138]
 [ 90 134 201 358 523 685 752 713 693 535 377 233 112  83]
 [ 45  81 169 331 482 609 706 674 637 452 294 167  85  39]
 [ 22  48 119 202 330 531 590 543 491 346 229 105  45  21]
 [ 12  19  71 114 219 307 323 352 280 198 126  62  29  16]
 [  7  15  28  58  88 150 147 158 130 103  61  30   6   5]
 [  0   5   6  31  32  66  84  75  63  29  24  10   4   1]
 [  0   0   4   9   9  26  20  29  22  11   3   5   1   0]
 [  0   1   0   1   9  10  16  14  13   5   4   2   0   0]
 [  0   0   2   4   2   3   8  11   4   2   1   0   0   0]
 [  0   0   0   0   3   0   1   1   2   2   0   0   0   0]
 [  0   0   0   0   0   0   1   0   1   0   0   0   0   0]]
[2022-11-30 15:53:15,661] INFO: label_uds:
 [[ 883  570  579  800  877 1013  947  929  989  914  751  567  625  888]
 [1209  643  606  845  936 1099 1101 1243 1072 1029  770  588  632 1224]
 [1260  614  705 1032 1336 1550 1666 1623 1458 1299 1027  707  584 1325]
 [ 874  551  702 1054 1463 1660 1822 1765 1730 1403  981  728  513  872]
 [ 628  395  726 1004 1410 1829 1941 2000 1776 1443 1042  695  426  596]
 [ 413  318  475  854 1250 1564 1758 1703 1532 1198  855  498  295  389]
 [ 278  213  359  644  881 1190 1331 1316 1199  825  614  356  228  222]
 [ 174  138  224  350  498  731  763  806  707  505  362  225  119  102]
 [  55   65  134  176  257  343  369  387  360  242  175  118   72   53]
 [  14   31   49  101  114  153  169  150  129   95   88   58   28    9]
 [   2   16   25   48   48   61   58   69   49   42   46   27   12    2]
 [   0    4    5   20   19   19   23   26   28   17   21   13    3    0]
 [   0    1    3   11    8   14   14   10   12   11    7    6    1    0]
 [   0    0    1    2    3    4    3    7    7    4    1    2    0    0]
 [   0    0    0    0    1    0    1    4    1    1    1    0    0    0]]
[2022-11-30 15:53:15,679] INFO: label_g:
 [[1827 1834 1546 2164 2509 2644 2892 2759 2811 2443 2142 1574 1821 1921]
 [2207 1406 1127 1508 1851 2187 2156 2257 2193 1901 1537 1157 1403 2210]
 [1826 1052  923 1325 1760 2099 2276 2163 2032 1763 1364 1032  981 1817]
 [ 779  539  708 1073 1328 1573 1715 1765 1622 1325 1044  738  517  763]
 [ 365  356  561  884 1144 1485 1544 1619 1505 1140  899  584  302  405]
 [ 173  205  390  647  864 1029 1141 1176 1058  879  652  355  195  174]
 [  80  107  221  430  619  829  874  872  752  634  400  239  109   82]
 [  35   59  126  243  312  499  536  525  459  367  240  152   69   22]
 [   9   18   51  118  183  251  294  300  252  169  128   62   21    7]
 [   2   14   27   59   87  110  152  135  118   96   44   33    5    1]
 [   0    0    8   19   35   43   59   60   53   27   21   12    6    1]
 [   0    0    2    3   12   24   33   18   21   16   10    7    1    0]
 [   0    0    0    0    3   11   13    9   11    1    4    1    0    0]
 [   0    0    0    0    2    1    8    3    2    2    0    0    0    0]
 [   0    0    0    0    0    0    0    1    1    0    0    0    0    0]]
[2022-11-30 15:53:15,683] INFO: label_undef:
 [[ 25  38  57  62  85  91 122 115  94  94  71  42  44  33]
 [ 25  35  69 118 119 136 152 155 142 118  95  64  43  31]
 [ 35  41  76 124 180 203 213 202 216 180 125  81  43  33]
 [ 22  18  64 149 194 214 275 265 227 164 130  75  37  17]
 [ 15  22  79 127 213 233 292 275 251 184 137  68  31  12]
 [  5  24  55  98 144 159 206 187 182 148  98  62  10   8]
 [  6  12  37  62  99 141 191 182 135  98  67  47  11   2]
 [  1   7   8  44  49  60  87  78  78  65  43  18   4   1]
 [  0   2  10   8  22  36  34  46  30  25   9   4   5   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0]]
[2022-11-30 15:53:15,708] INFO: label_pu:
 [[24286 29060  3381  3817  5026  4906  4903  5043  5054  5670  3886  3669
  28614 23866]
 [23129 11548   780   766   996  1101  1234  1244  1217  1124   750   847
  10988 23701]
 [10588  2868   188   153   204   273   355   319   299   205   163   226
   2793 10691]
 [ 1508   339    48    41    53    53    66    75    76    48    32    46
    338  1520]
 [  183    55    17    11    13    24    26    32    16    20    12    16
     58   172]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]]
/m100/home/userexternal/mmalucch/weaver/utils/data/preprocess.py:190: RuntimeWarning: divide by zero encountered in true_divide
  wgt = np.clip(np.nan_to_num(ref_val / hist, posinf=0), 0, 1)
[2022-11-30 15:53:15,712] INFO: weights:
[2022-11-30 15:53:15,715] INFO: label_catB:
 [[0.02932046 0.02057812 0.01510448 0.01036035 0.00930712 0.00888323
  0.00908103 0.00975224 0.00928785 0.00930712 0.01008097 0.01602153
  0.01787263 0.03093814]
 [0.01787263 0.01546907 0.01045695 0.00784271 0.00641778 0.00591045
  0.00636316 0.00586409 0.00693359 0.00652039 0.00769473 0.01199473
  0.01367692 0.0190086 ]
 [0.01410701 0.00962667 0.00737834 0.00464392 0.00380494 0.00345079
  0.00332053 0.00338824 0.00324135 0.003754   0.00501793 0.00727071
  0.01048138 0.01447106]
 [0.01536311 0.01003586 0.0063722  0.00398051 0.00288491 0.00252166
  0.00241055 0.00233769 0.00256052 0.00296695 0.00384407 0.0061706
  0.01058026 0.01643234]
 [0.02057812 0.00979482 0.00578842 0.00329613 0.00231956 0.00187074
  0.00170507 0.0016789  0.00182359 0.00226682 0.00330584 0.00523457
  0.01174353 0.01933633]
 [0.03298551 0.01495343 0.00662634 0.00349379 0.00245406 0.00178798
  0.00160559 0.00168331 0.001814   0.00235859 0.00356317 0.00652039
  0.01661492 0.03159176]
 [0.06501492 0.0212608  0.00893631 0.00488674 0.00277601 0.00209139
  0.00184004 0.00180743 0.00211805 0.00299668 0.00458694 0.00909945
  0.02438059 0.06230596]
 [0.17944118 0.04531343 0.01933633 0.00774789 0.00495694 0.00328406
  0.00285371 0.00287382 0.00319974 0.00504615 0.00824638 0.01745537
  0.04876119 0.17944118]
 [0.17944118 0.16021535 0.06145246 0.02146426 0.0124959  0.0076423
  0.00598936 0.00612846 0.00766843 0.0130788  0.0190086  0.05538308
  0.17944118 0.17944118]
 [0.17944118 0.17944118 0.17944118 0.05607537 0.03900895 0.01801618
  0.01643234 0.01579588 0.02076866 0.03769773 0.06145246 0.17944118
  0.17944118 0.        ]
 [0.         0.17944118 0.17944118 0.16614924 0.11215074 0.05981373
  0.04153731 0.03677073 0.05340511 0.10681023 0.17944118 0.17944118
  0.17944118 0.        ]
 [0.         0.         0.         0.17944118 0.17944118 0.17944118
  0.17253959 0.09752238 0.17944118 0.17944118 0.17944118 0.
  0.         0.        ]
 [0.         0.         0.         0.17944118 0.17944118 0.17944118
  0.17944118 0.17944118 0.17944118 0.17944118 0.17944118 0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.17944118
  0.17944118 0.17944118 0.17944118 0.17944118 0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.17944118 0.         0.         0.17944118 0.
  0.         0.        ]]
[2022-11-30 15:53:15,717] INFO: label_catC:
 [[0.0282941  0.0221803  0.0221803  0.01628738 0.01491176 0.01401232
  0.01202692 0.01275688 0.01264722 0.01396798 0.01808967 0.02062561
  0.0220694  0.02884889]
 [0.0220694  0.02507886 0.0219596  0.01599232 0.01309757 0.01232927
  0.01050924 0.01232927 0.01087163 0.01294393 0.01616806 0.02298896
  0.0219596  0.0220694 ]
 [0.02072244 0.02185089 0.01894369 0.01196173 0.00898957 0.00825024
  0.0082812  0.0074433  0.00860405 0.00949221 0.01180182 0.01970482
  0.02493718 0.02024716]
 [0.03369374 0.02942587 0.01944441 0.01143492 0.00945156 0.00771657
  0.00674905 0.00683263 0.00779837 0.00893498 0.01317576 0.01823917
  0.03086629 0.03198464]
 [0.04904311 0.0329394  0.0219596  0.01232927 0.00843954 0.00644362
  0.00586952 0.00619057 0.00636923 0.00825024 0.0117079  0.01894369
  0.03940964 0.05317928]
 [0.09808622 0.05449234 0.02611763 0.01333498 0.00915743 0.00724775
  0.00625195 0.00654878 0.00692917 0.00976522 0.0150132  0.02643042
  0.051928   0.11317641]
 [0.2006309  0.09195583 0.03709143 0.02185089 0.01337539 0.00831239
  0.00748115 0.00812869 0.00898957 0.01275688 0.01927458 0.04203695
  0.09808622 0.21018475]
 [0.36782333 0.23230946 0.06216732 0.03871825 0.0201547  0.01437746
  0.01366526 0.01253943 0.01576386 0.02229232 0.03503079 0.07119161
  0.15220276 0.2758675 ]
 [0.44584647 0.29425865 0.15763856 0.07610138 0.05015773 0.02942587
  0.03002639 0.02793595 0.03395292 0.0428532  0.07235868 0.14712933
  0.44584647 0.44584647]
 [0.         0.44584647 0.44584647 0.14238322 0.13793375 0.06687696
  0.05254619 0.05885173 0.07006159 0.15220276 0.18391167 0.44138798
  0.44584647 0.44584647]
 [0.         0.         0.44584647 0.44584647 0.44584647 0.16976461
  0.22069399 0.15220276 0.2006309  0.4012618  0.44584647 0.44584647
  0.44584647 0.        ]
 [0.         0.44584647 0.         0.44584647 0.44584647 0.44138798
  0.2758675  0.31527713 0.33952922 0.44584647 0.44584647 0.44584647
  0.         0.        ]
 [0.         0.         0.44584647 0.44584647 0.44584647 0.44584647
  0.44584647 0.4012618  0.44584647 0.44584647 0.44584647 0.
  0.         0.        ]
 [0.         0.         0.         0.         0.44584647 0.
  0.44584647 0.44584647 0.44584647 0.44584647 0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.44584647 0.         0.44584647 0.         0.         0.
  0.         0.        ]]
[2022-11-30 15:53:15,735] INFO: label_uds:
 [[0.01175437 0.01820897 0.01792593 0.01297389 0.01183479 0.01024592
  0.01095999 0.01117235 0.01049455 0.0113557  0.01382039 0.01830531
  0.01660658 0.01168819]
 [0.00858487 0.0161417  0.01712725 0.01228297 0.0110888  0.00944414
  0.00942699 0.00835005 0.00968201 0.0100866  0.01347937 0.01765155
  0.01642265 0.00847967]
 [0.00823739 0.01690409 0.01472215 0.01005728 0.0077688  0.0066962
  0.00622996 0.00639502 0.00711873 0.00799008 0.01010624 0.0146805
  0.01777245 0.00783329]
 [0.01187541 0.01883686 0.01478506 0.00984736 0.0070944  0.00625248
  0.00569655 0.00588052 0.00599949 0.0073978  0.01058013 0.01425702
  0.02023219 0.01190265]
 [0.01652725 0.02627623 0.0142963  0.01033776 0.00736107 0.00567475
  0.0053473  0.00518956 0.00584409 0.00719273 0.00996076 0.01493398
  0.02436411 0.01741462]
 [0.02513102 0.03263872 0.02185076 0.01215353 0.00830329 0.00663626
  0.00590393 0.00609461 0.00677488 0.0086637  0.01213931 0.02084159
  0.03518343 0.02668152]
 [0.03733494 0.04872823 0.02891118 0.01611663 0.01178106 0.00872194
  0.00779798 0.00788686 0.00865647 0.01258074 0.01690409 0.02915481
  0.04552243 0.04675276]
 [0.05965007 0.07521096 0.04633532 0.02965461 0.02084159 0.01419851
  0.01360303 0.01287731 0.0146805  0.0205527  0.02867158 0.04612939
  0.08721943 0.101756  ]
 [0.18871114 0.15967865 0.07745606 0.05897223 0.04038565 0.0302598
  0.02812768 0.02681941 0.02883087 0.04288889 0.05930921 0.08795858
  0.14415434 0.19583231]
 [0.43609717 0.33481008 0.21181862 0.10276349 0.09104485 0.06783734
  0.06141487 0.06919408 0.08045824 0.10925382 0.11794446 0.1789502
  0.3706826  0.43609717]
 [0.43609717 0.43609717 0.4151645  0.21623151 0.21623151 0.17014939
  0.1789502  0.15042192 0.21181862 0.24712174 0.22563288 0.38441157
  0.43609717 0.43609717]
 [0.         0.43609717 0.43609717 0.43609717 0.43609717 0.43609717
  0.43609717 0.39919662 0.3706826  0.43609717 0.43609717 0.43609717
  0.43609717 0.        ]
 [0.         0.43609717 0.43609717 0.43609717 0.43609717 0.43609717
  0.43609717 0.43609717 0.43609717 0.43609717 0.43609717 0.43609717
  0.43609717 0.        ]
 [0.         0.         0.43609717 0.43609717 0.43609717 0.43609717
  0.43609717 0.43609717 0.43609717 0.43609717 0.43609717 0.43609717
  0.         0.        ]
 [0.         0.         0.         0.         0.43609717 0.
  0.43609717 0.43609717 0.43609717 0.43609717 0.43609717 0.
  0.         0.        ]]
[2022-11-30 15:53:15,737] INFO: label_g:
 [[0.01226601 0.01221919 0.01449547 0.01035582 0.00893184 0.00847579
  0.00774896 0.00812251 0.00797225 0.00917315 0.01046218 0.01423761
  0.01230642 0.0116658 ]
 [0.01015406 0.01593883 0.01988465 0.01486074 0.01210697 0.01024691
  0.01039425 0.00992911 0.01021888 0.01178853 0.01458035 0.01936906
  0.01597291 0.01014027]
 [0.01227273 0.02130228 0.02427952 0.01691321 0.01273295 0.01067651
  0.00984622 0.01036061 0.01102854 0.01271129 0.01642962 0.02171512
  0.02284404 0.01233352]
 [0.02876765 0.04157699 0.03165254 0.02088537 0.016875   0.01424666
  0.01306705 0.01269688 0.01381628 0.01691321 0.02146552 0.03036585
  0.04334623 0.0293709 ]
 [0.06139726 0.06294943 0.03994652 0.02535068 0.01958916 0.01509091
  0.01451425 0.01384188 0.01489037 0.01965789 0.0249277  0.03837329
  0.07420529 0.05533333]
 [0.12953757 0.10931706 0.05746154 0.03463678 0.0259375  0.02177843
  0.01964067 0.01905612 0.02118147 0.02549488 0.03437116 0.06312676
  0.11492307 0.1287931 ]
 [0.280125   0.20943923 0.10140271 0.05211627 0.03620355 0.02703257
  0.02564073 0.02569954 0.02980053 0.035347   0.056025   0.09376568
  0.20559631 0.2732927 ]
 [0.64028573 0.3798305  0.17785715 0.09222221 0.07182692 0.04490982
  0.0418097  0.04268571 0.04882353 0.06106267 0.093375   0.1474342
  0.32478258 0.9       ]
 [0.9        0.9        0.43941176 0.18991525 0.12245901 0.08928286
  0.07622449 0.0747     0.08892857 0.13260354 0.17507812 0.3614516
  0.9        0.9       ]
 [0.9        0.9        0.83       0.3798305  0.2575862  0.20372726
  0.1474342  0.166      0.18991525 0.2334375  0.5093182  0.67909086
  0.9        0.9       ]
 [0.         0.         0.9        0.9        0.64028573 0.52116275
  0.3798305  0.3735     0.42283016 0.83       0.9        0.9
  0.9        0.9       ]
 [0.         0.         0.9        0.9        0.9        0.9
  0.67909086 0.9        0.9        0.9        0.9        0.9
  0.9        0.        ]
 [0.         0.         0.         0.         0.9        0.9
  0.9        0.9        0.9        0.9        0.9        0.9
  0.         0.        ]
 [0.         0.         0.         0.         0.9        0.9
  0.9        0.9        0.9        0.9        0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.9        0.9        0.         0.         0.
  0.         0.        ]]
[2022-11-30 15:53:15,740] INFO: label_undef:
 [[0.03578365 0.02354187 0.01569458 0.01442889 0.0105246  0.00983067
  0.00733271 0.00777905 0.00951693 0.00951693 0.01259988 0.02129979
  0.02033162 0.02710882]
 [0.03578365 0.02555975 0.01296509 0.00758128 0.00751757 0.00657788
  0.00588547 0.00577156 0.00629994 0.00758128 0.00941675 0.01397799
  0.02080445 0.02885778]
 [0.02555975 0.0218193  0.01177094 0.00721445 0.00496995 0.00440685
  0.00419996 0.00442867 0.00414163 0.00496995 0.00715673 0.01104434
  0.02080445 0.02710882]
 [0.04066323 0.04969951 0.01397799 0.00600397 0.00461129 0.00418033
  0.00325306 0.00337582 0.00394093 0.00545482 0.00688147 0.01192788
  0.02417814 0.05262301]
 [0.05963941 0.04066323 0.01132394 0.00704402 0.00419996 0.00383945
  0.00306367 0.00325306 0.00356411 0.00486191 0.00652986 0.01315575
  0.02885778 0.06701057]
 [0.06701057 0.03727463 0.01626529 0.00912848 0.00621244 0.00562636
  0.00434268 0.00478391 0.00491534 0.00604453 0.00912848 0.01442889
  0.06701057 0.06701057]
 [0.06701057 0.06701057 0.02417814 0.01442889 0.00903627 0.00634462
  0.00468372 0.00491534 0.0066266  0.00912848 0.01335211 0.01903385
  0.06701057 0.06701057]
 [0.06701057 0.06701057 0.06701057 0.02033162 0.01825696 0.01490985
  0.01028266 0.01146912 0.01146912 0.01376294 0.02080445 0.04969951
  0.06701057 0.06701057]
 [0.         0.06701057 0.06701057 0.06701057 0.04066323 0.02484976
  0.02631151 0.01944763 0.02981971 0.03578365 0.06701057 0.06701057
  0.06701057 0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
[2022-11-30 15:53:15,742] INFO: label_pu:
 [[0.00043054 0.00035981 0.00309261 0.00273935 0.0020804  0.00213129
  0.00213259 0.00207339 0.00206888 0.00184411 0.00269071 0.00284985
  0.00036542 0.00043812]
 [0.00045208 0.00090545 0.01340526 0.01365026 0.01049809 0.00949691
  0.00847334 0.00840522 0.0085917  0.00930258 0.01394147 0.01234486
  0.00095159 0.00044117]
 [0.00098754 0.00364578 0.05561755 0.06834052 0.05125539 0.03830073
  0.0294538  0.03277774 0.03497023 0.05100536 0.06414785 0.04626593
  0.00374368 0.00097803]
 [0.00693375 0.03084395 0.2178354  0.25502682 0.19728489 0.19728489
  0.15842575 0.13941465 0.13758025 0.2178354  0.2974708  0.22730651
  0.03093521 0.00687901]
 [0.05713715 0.1901109  0.2974708  0.2974708  0.2974708  0.2974708
  0.2974708  0.2974708  0.2974708  0.2974708  0.2974708  0.2974708
  0.18027757 0.06079127]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
[2022-11-30 15:53:15,742] INFO: Raw hist * weights:
[2022-11-30 15:53:15,743] INFO: label_catB:
 [[4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 3]
 [0 4 4 4 4 4 4 4 4 4 4 4 4 0]
 [0 1 3 4 4 4 4 4 4 4 4 3 1 0]
 [0 0 0 4 4 4 4 4 4 4 3 1 0 0]
 [0 0 0 0 3 4 4 4 3 4 1 0 0 0]
 [0 0 0 0 0 1 1 2 1 0 0 0 0 0]
 [0 0 0 0 0 1 1 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]]
[2022-11-30 15:53:15,744] INFO: label_catC:
 [[4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [4 4 4 4 4 4 4 4 4 4 4 4 4 4]
 [3 4 4 4 4 4 4 4 4 4 4 4 2 2]
 [0 2 2 4 4 4 4 4 4 4 4 4 1 0]
 [0 0 1 4 4 4 4 4 4 4 1 2 0 0]
 [0 0 0 0 4 4 4 4 4 2 1 0 0 0]
 [0 0 0 1 0 1 3 4 1 0 0 0 0 0]
 [0 0 0 0 1 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]]
[2022-11-30 15:53:15,745] INFO: label_uds:
 [[10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [ 6 10 10 10 10 10 10 10 10 10 10 10 10  3]
 [ 0  6 10 10 10 10 10 10 10 10 10 10  5  0]
 [ 0  1  2  8  8  8 10 10 10  7  9  5  1  0]
 [ 0  0  1  4  3  6  6  4  5  4  3  2  0  0]
 [ 0  0  0  0  1  1  1  3  3  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0]]
[2022-11-30 15:53:15,746] INFO: label_g:
 [[22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 22]
 [22 22 22 22 22 22 22 22 22 22 22 22 22 19]
 [ 8 16 22 22 22 22 22 22 22 22 22 22 18  6]
 [ 1 12 22 22 22 22 22 22 22 22 22 22  4  0]
 [ 0  0  7 17 22 22 22 22 22 22 18 10  5  0]
 [ 0  0  1  2 10 21 22 16 18 14  9  6  0  0]
 [ 0  0  0  0  2  9 11  8  9  0  3  0  0  0]
 [ 0  0  0  0  1  0  7  2  1  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]]
[2022-11-30 15:53:15,747] INFO: label_undef:
 [[0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]]
[2022-11-30 15:53:15,748] INFO: label_pu:
 [[10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10 10 10 10 10]
 [10 10 10 10 10 10 10 10 10 10  9 10 10 10]
 [10 10  5  3  3  7  7  9  4  5  3  4 10 10]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]]
[2022-11-30 15:53:15,748] INFO: Writing YAML file w/ reweighting info to data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.82a93bd1ead123871402e73dd2b0e098.auto.yaml
[2022-11-30 15:53:15,999] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.82a93bd1ead123871402e73dd2b0e098.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 15:53:16,187] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 15:53:16,187] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 15:53:16,187] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 15:53:16,188] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 15:53:16,188] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 15:53:16,188] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 15:53:16,188] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 15:53:16,188] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 15:53:16,189] INFO: label_names: ('_label_',)
[2022-11-30 15:53:16,189] INFO: observer_names: ()
[2022-11-30 15:53:16,189] INFO: monitor_variables: ()
[2022-11-30 15:53:16,189] INFO: reweight_method: flat
[2022-11-30 15:53:16,189] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 15:53:16,189] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 15:53:16,189] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 15:53:16,190] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 15:53:16,190] INFO: reweight_threshold: 15
[2022-11-30 15:53:16,190] INFO: reweight_discard_under_overflow: True
[2022-11-30 15:53:16,192] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.82a93bd1ead123871402e73dd2b0e098.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 15:53:16,379] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 15:53:16,379] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 15:53:16,379] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 15:53:16,379] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 15:53:16,379] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 15:53:16,380] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 15:53:16,380] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 15:53:16,380] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 15:53:16,380] INFO: label_names: ('_label_',)
[2022-11-30 15:53:16,380] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl')
[2022-11-30 15:53:16,381] INFO: monitor_variables: ()
[2022-11-30 15:53:16,381] INFO: reweight_method: flat
[2022-11-30 15:53:16,381] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 15:53:16,381] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 15:53:16,381] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 15:53:16,381] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 15:53:16,381] INFO: reweight_threshold: 15
[2022-11-30 15:53:16,381] INFO: reweight_discard_under_overflow: True
[2022-11-30 15:53:16,570] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 15:53:16,570] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 15:53:16,570] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 15:53:16,570] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 15:53:16,571] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 15:53:16,571] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 15:53:16,571] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 15:53:16,571] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 15:53:16,571] INFO: label_names: ('_label_',)
[2022-11-30 15:53:16,572] INFO: observer_names: ()
[2022-11-30 15:53:16,572] INFO: monitor_variables: ()
[2022-11-30 15:53:16,572] INFO: reweight_method: flat
[2022-11-30 15:53:16,572] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 15:53:16,572] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 15:53:16,572] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 15:53:16,572] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 15:53:16,572] INFO: reweight_threshold: 15
[2022-11-30 15:53:16,572] INFO: reweight_discard_under_overflow: True
[2022-11-30 15:53:16,594] INFO: Network options: {}
[2022-11-30 15:53:17,399] INFO: Warning: module FeatureConv is treated as a zero-op.
[2022-11-30 15:53:17,399] INFO: Warning: module EdgeConvBlock is treated as a zero-op.
[2022-11-30 15:53:17,400] INFO: Warning: module Dropout is treated as a zero-op.
[2022-11-30 15:53:17,400] INFO: Warning: module ParticleNet is treated as a zero-op.
[2022-11-30 15:53:17,400] INFO: Warning: module ParticleNetTagger is treated as a zero-op.
[2022-11-30 15:53:18,442] INFO: ParticleNetTagger(
  |0.579 M, 100.000% Params, 242.737 MMac, 100.000% MACs|
  (pf_conv): FeatureConv(
    |0.001 M, 0.128% Params, 38.8 KMac, 0.016% MACs|
    (conv): Sequential(
      |0.001 M, 0.128% Params, 38.8 KMac, 0.016% MACs|
      (0): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 2.0 KMac, 0.001% MACs|)
      (1): Conv1d(20, 32, kernel_size=(1,), stride=(1,), bias=False, |0.001 M, 0.110% Params, 32.0 KMac, 0.013% MACs|)
      (2): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.011% Params, 3.2 KMac, 0.001% MACs|)
      (3): ReLU(|0.0 M, 0.000% Params, 1.6 KMac, 0.001% MACs|)
    )
  )
  (sv_conv): FeatureConv(
    |0.0 M, 0.076% Params, 2.35 KMac, 0.001% MACs|
    (conv): Sequential(
      |0.0 M, 0.076% Params, 2.35 KMac, 0.001% MACs|
      (0): BatchNorm1d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.004% Params, 110.0 Mac, 0.000% MACs|)
      (1): Conv1d(11, 32, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.061% Params, 1.76 KMac, 0.001% MACs|)
      (2): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.011% Params, 320.0 Mac, 0.000% MACs|)
      (3): ReLU(|0.0 M, 0.000% Params, 160.0 Mac, 0.000% MACs|)
    )
  )
  (pn): ParticleNet(
    |0.578 M, 99.796% Params, 242.696 MMac, 99.983% MACs|
    (edge_convs): ModuleList(
      |0.305 M, 52.593% Params, 233.07 MMac, 96.017% MACs|
      (0): EdgeConvBlock(
        |0.015 M, 2.563% Params, 11.444 MMac, 4.714% MACs|
        (convs): ModuleList(
          |0.012 M, 2.121% Params, 10.813 MMac, 4.455% MACs|
          (0): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
          (1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
          (2): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
        )
        (bns): ModuleList(
          |0.0 M, 0.066% Params, 337.92 KMac, 0.139% MACs|
          (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
          (2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 168.96 KMac, 0.070% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
        )
        (sc): Conv1d(32, 64, kernel_size=(1,), stride=(1,), bias=False, |0.002 M, 0.354% Params, 112.64 KMac, 0.046% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 7.04 KMac, 0.003% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.52 KMac, 0.001% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 10.077% Params, 44.739 MMac, 18.431% MACs|
        (convs): ModuleList(
          |0.049 M, 8.486% Params, 43.254 MMac, 17.819% MACs|
          (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
          (1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
          (2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
        )
        (bns): ModuleList(
          |0.001 M, 0.133% Params, 675.84 KMac, 0.278% MACs|
          (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
          (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
          (2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 337.92 KMac, 0.139% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 1.414% Params, 450.56 KMac, 0.186% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 14.08 KMac, 0.006% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 7.04 KMac, 0.003% MACs|)
      )
      (2): EdgeConvBlock(
        |0.231 M, 39.953% Params, 176.887 MMac, 72.872% MACs|
        (convs): ModuleList(
          |0.197 M, 33.943% Params, 173.015 MMac, 71.277% MACs|
          (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
          (1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
          (2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
        )
        (bns): ModuleList(
          |0.002 M, 0.265% Params, 1.352 MMac, 0.557% MACs|
          (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
          (2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 675.84 KMac, 0.278% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
        )
        (sc): Conv1d(128, 256, kernel_size=(1,), stride=(1,), bias=False, |0.033 M, 5.657% Params, 1.802 MMac, 0.742% MACs|)
        (sc_bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 28.16 KMac, 0.012% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 14.08 KMac, 0.006% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.173 M, 29.832% Params, 9.525 MMac, 3.924% MACs|
      (0): Conv1d(448, 384, kernel_size=(1,), stride=(1,), bias=False, |0.172 M, 29.700% Params, 9.462 MMac, 3.898% MACs|)
      (1): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.133% Params, 42.24 KMac, 0.017% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 21.12 KMac, 0.009% MACs|)
    )
    (fc): Sequential(
      |0.101 M, 17.370% Params, 100.872 KMac, 0.042% MACs|
      (0): Sequential(
        |0.099 M, 17.015% Params, 98.816 KMac, 0.041% MACs|
        (0): Linear(in_features=384, out_features=256, bias=True, |0.099 M, 17.015% Params, 98.56 KMac, 0.041% MACs|)
        (1): ReLU(|0.0 M, 0.000% Params, 256.0 Mac, 0.000% MACs|)
        (2): Dropout(p=0.1, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
      (1): Linear(in_features=256, out_features=8, bias=True, |0.002 M, 0.355% Params, 2.056 KMac, 0.001% MACs|)
    )
  )
)
[2022-11-30 15:53:18,450] INFO: Computational complexity:       242.74 MMac
[2022-11-30 15:53:18,450] INFO: Number of parameters:           579.24 k
[2022-11-30 15:53:18,450] INFO: Using loss function CrossEntropyLoss() with options {}
[2022-11-30 15:53:36,186] INFO: Optimizer options: {}
[2022-11-30 15:53:36,241] INFO: --------------------------------------------------
[2022-11-30 15:53:36,241] INFO: Epoch #0 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=1045988699 ===
[2022-11-30 15:53:36,262] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
113it [01:31,  1.23it/s, lr=5.00e-03, Loss=1.15148, AvgLoss=1.39745, Acc=0.55664, AvgAcc=0.48935]
[2022-11-30 15:55:08,134] INFO: Processed 57856 entries in total (avg. speed 629.6 entries/s)
[2022-11-30 15:55:08,134] INFO: Train AvgLoss: 1.39745, AvgAcc: 0.48935
[2022-11-30 15:55:08,135] INFO: Train class distribution: 
    [(0, 5320), (1, 78), (2, 4802), (3, 581), (4, 13525), (5, 27267), (6, 779), (7, 5504)]
[2022-11-30 15:55:08,216] INFO: Epoch #0 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=1168124443 ===
[2022-11-30 15:55:08,276] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
29it [00:14,  2.03it/s, Loss=1.26368, AvgLoss=1.22745, Acc=0.53711, AvgAcc=0.52337]
[2022-11-30 15:55:22,518] INFO: Processed 14848 entries in total (avg. speed 1038.3 entries/s)
[2022-11-30 15:55:22,518] INFO: Evaluation class distribution: 
    [(0, 1385), (1, 23), (2, 1189), (3, 124), (4, 3381), (5, 7160), (6, 205), (7, 1381)]
[2022-11-30 15:55:22,711] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.7145031946197721
    - roc_auc_score_matrix: 
[[0.         0.3419871  0.7725176  0.7833469  0.8833859  0.8806961
  0.9646808  0.93915987]
 [0.         0.         0.3910118  0.5206872  0.73501533 0.7145251
  0.9346765  0.94115794]
 [0.         0.         0.         0.5162782  0.6928441  0.73474526
  0.94732195 0.9253609 ]
 [0.         0.         0.         0.         0.7057775  0.69061315
  0.9704563  0.9474025 ]
 [0.         0.         0.         0.         0.         0.73185503
  0.90074515 0.9335313 ]
 [0.         0.         0.         0.         0.         0.
  0.792843   0.92262346]
 [0.         0.         0.         0.         0.         0.
  0.         0.92558944]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[0.46642599 0.         0.         0.         0.28736462 0.233213
  0.         0.01299639]
 [0.69565217 0.         0.         0.         0.08695652 0.2173913
  0.         0.        ]
 [0.09335576 0.         0.         0.         0.58788898 0.31118587
  0.         0.00756939]
 [0.06451613 0.         0.         0.         0.55645161 0.37903226
  0.         0.        ]
 [0.00828157 0.         0.         0.         0.7364685  0.24785566
  0.         0.00739426]
 [0.00893855 0.         0.         0.         0.41019553 0.57276536
  0.         0.00810056]
 [0.0097561  0.         0.         0.         0.2        0.7804878
  0.         0.0097561 ]
 [0.02606807 0.         0.         0.         0.0948588  0.49239681
  0.         0.38667632]]
[2022-11-30 15:55:22,743] INFO: Epoch #0: Current validation metric: 0.52337 (best: 0.52337)
[2022-11-30 15:55:22,743] INFO: --------------------------------------------------
[2022-11-30 15:55:22,743] INFO: Epoch #1 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=905365928 ===
[2022-11-30 15:55:22,764] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
113it [00:56,  2.00it/s, lr=5.00e-03, Loss=1.08130, AvgLoss=1.10821, Acc=0.60742, AvgAcc=0.58936]
[2022-11-30 15:56:19,124] INFO: Processed 57856 entries in total (avg. speed 1026.2 entries/s)
[2022-11-30 15:56:19,124] INFO: Train AvgLoss: 1.10821, AvgAcc: 0.58936
[2022-11-30 15:56:19,125] INFO: Train class distribution: 
    [(0, 5370), (1, 88), (2, 4767), (3, 554), (4, 13698), (5, 27107), (6, 774), (7, 5498)]
[2022-11-30 15:56:19,231] INFO: Epoch #1 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=650525147 ===
[2022-11-30 15:56:19,254] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
28it [00:14,  2.00it/s, Loss=1.17938, AvgLoss=1.12023, Acc=0.54297, AvgAcc=0.58391]
[2022-11-30 15:56:33,239] INFO: Processed 14336 entries in total (avg. speed 1023.4 entries/s)
[2022-11-30 15:56:33,239] INFO: Evaluation class distribution: 
    [(0, 1369), (1, 39), (2, 1204), (3, 140), (4, 3386), (5, 6725), (6, 190), (7, 1283)]
[2022-11-30 15:56:33,427] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.7846025626642471
    - roc_auc_score_matrix: 
[[0.         0.37000617 0.77709675 0.7878952  0.8896108  0.89393663
  0.9656107  0.9548293 ]
 [0.         0.         0.72316635 0.7509157  0.91017306 0.90077585
  0.9819163  0.9750984 ]
 [0.         0.         0.         0.6754924  0.7160807  0.7552549
  0.9525441  0.92658854]
 [0.         0.         0.         0.         0.7674922  0.7260892
  0.97518796 0.9439539 ]
 [0.         0.         0.         0.         0.         0.7470514
  0.9493518  0.9382697 ]
 [0.         0.         0.         0.         0.         0.
  0.8815965  0.9314132 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.9620995 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[0.57341125 0.         0.02118335 0.         0.05332359 0.33382031
  0.         0.0182615 ]
 [0.61538462 0.         0.         0.         0.02564103 0.35897436
  0.         0.        ]
 [0.17192691 0.         0.02906977 0.         0.13372093 0.65863787
  0.         0.00664452]
 [0.13571429 0.         0.03571429 0.         0.05       0.77857143
  0.         0.        ]
 [0.01831069 0.         0.00502067 0.         0.25073833 0.71736562
  0.         0.00856468]
 [0.01843866 0.         0.00252788 0.         0.05472119 0.91643123
  0.         0.00788104]
 [0.03157895 0.         0.         0.         0.04736842 0.91052632
  0.         0.01052632]
 [0.02494154 0.         0.         0.         0.01402962 0.54091972
  0.         0.42010912]]
[2022-11-30 15:56:33,490] INFO: Epoch #1: Current validation metric: 0.58391 (best: 0.58391)
[2022-11-30 15:56:33,490] INFO: --------------------------------------------------
[2022-11-30 15:56:33,491] INFO: Epoch #2 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=461384545 ===
[2022-11-30 15:56:33,511] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
112it [00:55,  2.02it/s, lr=5.00e-05, Loss=1.14935, AvgLoss=1.06446, Acc=0.58008, AvgAcc=0.60570]
[2022-11-30 15:57:28,904] INFO: Processed 57344 entries in total (avg. speed 1034.9 entries/s)
[2022-11-30 15:57:28,904] INFO: Train AvgLoss: 1.06446, AvgAcc: 0.60570
[2022-11-30 15:57:28,904] INFO: Train class distribution: 
    [(0, 5379), (1, 82), (2, 4795), (3, 577), (4, 13448), (5, 26788), (6, 824), (7, 5451)]
[2022-11-30 15:57:29,170] INFO: Epoch #2 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=1445898984 ===
[2022-11-30 15:57:29,191] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
28it [00:13,  2.02it/s, Loss=1.01096, AvgLoss=1.07762, Acc=0.63086, AvgAcc=0.60052]
[2022-11-30 15:57:43,003] INFO: Processed 14336 entries in total (avg. speed 1036.4 entries/s)
[2022-11-30 15:57:43,004] INFO: Evaluation class distribution: 
    [(0, 1359), (1, 30), (2, 1255), (3, 179), (4, 3334), (5, 6651), (6, 204), (7, 1324)]
[2022-11-30 15:57:43,190] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.797066638043461
    - roc_auc_score_matrix: 
[[0.         0.36271766 0.79701734 0.8018507  0.91030556 0.9164056
  0.971728   0.9493813 ]
 [0.         0.         0.7238778  0.6975791  0.9222155  0.8961058
  0.9924836  0.9845669 ]
 [0.         0.         0.         0.698097   0.7262845  0.78955764
  0.95761263 0.93011695]
 [0.         0.         0.         0.         0.7945042  0.75578666
  0.98491067 0.9577798 ]
 [0.         0.         0.         0.         0.         0.7619553
  0.94633126 0.945502  ]
 [0.         0.         0.         0.         0.         0.
  0.8840289  0.93762106]
 [0.         0.         0.         0.         0.         0.
  0.         0.96992177]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[0.56732892 0.         0.00956586 0.         0.08241354 0.30022075
  0.         0.04047093]
 [0.56666667 0.         0.         0.         0.03333333 0.4
  0.         0.        ]
 [0.16095618 0.         0.03585657 0.         0.26135458 0.50517928
  0.         0.03665339]
 [0.1452514  0.         0.01117318 0.         0.18994413 0.65363128
  0.         0.        ]
 [0.0194961  0.         0.00509898 0.         0.40221956 0.5479904
  0.         0.02519496]
 [0.01819275 0.         0.00195459 0.         0.10494662 0.8418283
  0.         0.03307773]
 [0.0245098  0.         0.         0.         0.05392157 0.88235294
  0.         0.03921569]
 [0.0234139  0.         0.         0.         0.02945619 0.30287009
  0.         0.64425982]]
[2022-11-30 15:57:43,254] INFO: Epoch #2: Current validation metric: 0.60052 (best: 0.60052)
[2022-11-30 15:57:43,254] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.82a93bd1ead123871402e73dd2b0e098.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 15:57:43,442] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 15:57:43,442] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 15:57:43,442] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 15:57:43,442] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 15:57:43,443] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 15:57:43,443] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 15:57:43,443] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 15:57:43,443] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 15:57:43,443] INFO: label_names: ('_label_',)
[2022-11-30 15:57:43,443] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl')
[2022-11-30 15:57:43,444] INFO: monitor_variables: ()
[2022-11-30 15:57:43,444] INFO: reweight_method: flat
[2022-11-30 15:57:43,444] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 15:57:43,444] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 15:57:43,444] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 15:57:43,444] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 15:57:43,444] INFO: reweight_threshold: 15
[2022-11-30 15:57:43,444] INFO: reweight_discard_under_overflow: True
[2022-11-30 15:57:43,448] INFO: Loading model models_3/_best_epoch_state.pt for eval
[2022-11-30 15:57:43,471] INFO: Running on test file group  with 1 files:
.../m100_work/INF22_lhc_0/mmalucch/output_127.root
[2022-11-30 15:57:43,471] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7_new.82a93bd1ead123871402e73dd2b0e098.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 15:57:43,669] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 15:57:43,669] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 15:57:43,669] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 15:57:43,669] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 15:57:43,669] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 15:57:43,669] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 15:57:43,669] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 15:57:43,669] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 15:57:43,713] INFO: label_names: ('_label_',)
[2022-11-30 15:57:43,713] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl')
[2022-11-30 15:57:43,713] INFO: monitor_variables: ()
[2022-11-30 15:57:43,713] INFO: reweight_method: flat
[2022-11-30 15:57:43,713] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 15:57:43,713] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 15:57:43,713] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 15:57:43,714] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 15:57:43,714] INFO: reweight_threshold: 15
[2022-11-30 15:57:43,714] INFO: reweight_discard_under_overflow: True
0it [00:00, ?it/s]=== Restarting DataIter test__worker0, seed=3513319677 ===
[2022-11-30 15:57:43,736] INFO: Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
0it [00:14, ?it/s]
Traceback (most recent call last):
  File "train.py", line 889, in <module>
    main(args)
  File "train.py", line 821, in main
    test_metric, scores, labels, observers = evaluate(
  File "/m100/home/userexternal/mmalucch/weaver/utils/nn/tools.py", line 139, in evaluate_classification
    for X, y, Z in tq:
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1203, in _next_data
    return self._process_data(data)
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1229, in _process_data
    data.reraise()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 218, in __next__
    i = self.indices[self.cursor]
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 32, in fetch
    data.append(next(self.dataset_iter))
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 236, in __next__
    self.table, self.indices = self.prefetch.result()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/_base.py", line 444, in result
    return self.__get_result()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 132, in _load_next
    indices = _preprocess(table, data_config, options)
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 110, in _preprocess
    _check_labels(table)
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 96, in _check_labels
    raise RuntimeError('Inconsistent label definition: some of the entries are not assigned to any classes!')
RuntimeError: Inconsistent label definition: some of the entries are not assigned to any classes!


