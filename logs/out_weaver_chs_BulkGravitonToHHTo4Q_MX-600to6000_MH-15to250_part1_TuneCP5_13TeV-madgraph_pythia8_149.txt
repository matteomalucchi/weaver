(weaver) [mmalucch@r249n07 weaver]$ python train.py --data-train $WORK/$USER/output_149.root  --data-test $WORK/$USER/output_149.root  --data-config data/AK4/ak4_points_pf_sv_CHS_eta4p7.yaml  --network-config networks/particle_net_pf_sv.py  --model-prefix models_3/  --gpus 0,1,2,3 --batch-size 512 --start-lr 5e-3 --num-epochs 3 --optimizer ranger  --log logs/train3_chs.log
[2022-11-30 13:06:47,062] INFO: args:
 - ('regression_mode', False)
 - ('data_config', 'data/AK4/ak4_points_pf_sv_CHS_eta4p7.yaml')
 - ('data_train', ['/m100_work/INF22_lhc_0/mmalucch/output_149.root'])
 - ('data_val', [])
 - ('data_test', ['/m100_work/INF22_lhc_0/mmalucch/output_149.root'])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', False)
 - ('fetch_step', 0.01)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', None)
 - ('tensorboard_custom_fn', None)
 - ('network_config', 'networks/particle_net_pf_sv.py')
 - ('network_option', [])
 - ('model_prefix', 'models_3/')
 - ('load_model_weights', None)
 - ('num_epochs', 3)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 512)
 - ('use_amp', False)
 - ('gpus', '0,1,2,3')
 - ('predict_gpus', '0,1,2,3')
 - ('num_workers', 1)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', 'logs/train3_chs.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('local_rank', None)
[2022-11-30 13:06:47,062] INFO: Running in classification mode
[2022-11-30 13:06:49,220] INFO: Using 1 files for training, range: (0, 0.8)
[2022-11-30 13:06:49,220] INFO: Using 1 files for validation, range: (0.8, 1)
[2022-11-30 13:06:49,298] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 13:06:49,298] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 13:06:49,298] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 13:06:49,298] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 13:06:49,298] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 13:06:49,298] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 13:06:49,310] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 13:06:49,310] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 13:06:49,310] INFO: label_names: ('_label_',)
[2022-11-30 13:06:49,310] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 13:06:49,310] INFO: monitor_variables: ()
[2022-11-30 13:06:49,310] INFO: reweight_method: flat
[2022-11-30 13:06:49,310] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 13:06:49,310] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 13:06:49,311] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 13:06:49,311] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 13:06:49,311] INFO: reweight_threshold: 15
[2022-11-30 13:06:49,311] INFO: reweight_discard_under_overflow: True
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.36s/it]
[2022-11-30 13:06:51,789] INFO: Using 504727 events to make weights
[2022-11-30 13:06:51,795] INFO: label_catB:
 [[ 17  26  27  56  63  74  85 110  84  83  48  37  27  13]
 [ 31  32  39  63  82  90 138 115 113  88  47  32  35  34]
 [ 31  26  26  59  79 147 159 155 119  97  70  45  21  23]
 [ 11  20  38  63 108 168 166 155 162  94  60  40  24  15]
 [ 13  15  36  62 108 176 205 216 169 111  67  37  20  14]
 [  6  11  25  86 114 160 251 249 182 129  58  28  11  11]
 [  3   8  31  61 145 214 254 253 225 119  65  17  17   3]
 [  0   6  31  85 164 230 354 281 262 142  73  32   6   1]
 [  0   7  30  87 166 267 361 363 267 158  79  16   4   1]
 [  0   3  30 109 182 346 416 410 331 193  72  27   4   0]
 [  0   0  25  72 186 354 510 437 337 175  83  21   1   0]
 [  0   0  12  55 212 393 499 503 355 208  71   8   1   0]
 [  0   1   7  61 196 357 547 546 417 175  54   9   0   0]
 [  0   0   3  39 223 461 659 729 487 194  54   3   1   0]
 [  0   0   2  38 215 627 928 959 679 243  28   6   0   0]]
[2022-11-30 13:06:51,801] INFO: label_catC:
 [[103  85 102 121 152 204 187 221 172 162 112  98  88 101]
 [123  69  80 101 124 141 175 181 175 147 109  69  85 129]
 [117  69  78 115 158 203 241 223 187 153 115  71  73 122]
 [ 65  61  65  92 140 205 225 213 191 140 102  68  43  65]
 [ 37  56  64  96 163 220 271 262 220 158  97  58  39  43]
 [ 25  31  48  96 148 200 265 302 231 147 104  48  35  17]
 [ 20  22  48 110 164 244 313 287 243 167  95  54  29  15]
 [  4  19  44  92 169 295 338 359 307 199 105  52  24   4]
 [  2  14  39 118 201 305 394 390 327 186 127  44  12   5]
 [  3   7  29  91 223 357 490 435 381 226  87  44   5   3]
 [  1   1  27 100 206 390 474 453 373 212  96  29   6   0]
 [  0   1  18  85 227 366 497 527 375 186  90  21   2   0]
 [  0   0   7  65 204 430 531 535 422 202  61  15   0   0]
 [  0   0   7  52 232 470 652 632 452 227  60   2   1   0]
 [  0   0   1  47 236 608 946 864 605 227  46   1   0   0]]
[2022-11-30 13:06:51,811] INFO: label_uds:
 [[ 790  336  233  282  298  319  353  340  352  292  290  255  332  727]
 [1064  305  193  190  192  217  266  278  241  209  179  203  280 1060]
 [1202  290  226  211  232  251  264  267  238  224  222  196  295 1160]
 [ 882  263  220  192  206  201  257  238  223  202  207  216  263  940]
 [ 672  259  216  174  226  220  263  264  231  236  178  207  293  675]
 [ 460  249  256  226  246  291  320  294  251  221  197  238  271  509]
 [ 343  266  291  246  291  315  366  351  315  248  271  289  245  323]
 [ 222  214  261  305  343  375  413  383  350  318  302  273  184  201]
 [  98  179  243  282  338  433  449  473  402  335  327  259  149  110]
 [  35  120  221  325  405  485  569  523  485  384  313  196  102   36]
 [  11   63  173  328  450  504  571  623  543  385  286  165   48   13]
 [   0   11  102  271  424  566  636  642  562  407  235  112   33    3]
 [   0    6   41  184  346  552  675  682  567  324  179   43    3    1]
 [   0    1   16  107  278  580  745  758  589  301  123   15    0    0]
 [   0    0    2   61  259  653  889  908  604  286   55    4    0    0]]
[2022-11-30 13:06:51,827] INFO: label_g:
 [[1849 1633 1374 1832 1851 2002 1951 1915 1973 1882 1738 1381 1618 1778]
 [2133 1300 1098 1403 1521 1560 1572 1588 1554 1584 1333 1110 1310 2290]
 [1878 1152 1015 1248 1442 1398 1517 1494 1569 1384 1258 1004 1036 1886]
 [ 853  632  735  997 1092 1224 1166 1193 1156 1211  928  729  555  895]
 [ 439  421  647  843  963 1075 1116 1117 1073  990  802  615  389  406]
 [ 195  260  381  594  810  899  973  855  899  778  645  430  224  211]
 [  80  156  302  510  723  834  817  858  841  713  483  308  149   77]
 [  28   83  183  374  557  677  765  718  722  557  405  189   84   23]
 [   7   39  124  261  437  558  579  619  487  405  232  112   32    8]
 [   4    9   54  169  312  456  455  511  435  283  165   79    9    3]
 [   0    4   29  114  196  307  367  355  295  166   84   24    4    0]
 [   0    2    5   43  126  210  268  256  244  111   53    4    0    0]
 [   0    0    3   13   45  132  180  168  119   64   18    4    0    0]
 [   0    0    0    3   22   65   98   95   53   26    6    0    0    0]
 [   0    0    0    4   10   23   54   43   33    7    1    1    0    0]]
[2022-11-30 13:06:51,829] INFO: label_undef:
 [[ 7  9  6  5 11 11 22 17 12  9  7  3 11 13]
 [ 9  6  2  3  2 16 15 16 10  4  1  1  6  8]
 [ 7  1  1  0  1  7  9  8  2  2  0  2  2  4]
 [ 1  0  0  0  2  1  4  4  4  4  0  1  2  7]
 [ 2  1  0  4  2  1  3  2  3  1  2  2  0  0]
 [ 0  1  2  0  1  3  2  1  2  2  0  1  1  0]
 [ 1  0  2  0  1  1  0  0  0  0  0  0  0  0]
 [ 1  0  0  1  1  0  3  2  3  0  1  0  0  0]
 [ 0  0  0  2  0  0  0  1  1  1  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0]]
[2022-11-30 13:06:51,852] INFO: label_pu:
 [[23314 27898  3516  3905  5082  5526  6055  6208  5762  5739  3814  3539
  26955 23035]
 [21706 10927   785   760  1161  1384  1663  1715  1437  1236   836   872
  10356 22211]
 [ 9721  2762   219   157   221   373   400   470   355   254   161   196
   2647  9857]
 [ 1367   343    46    29    57    77    64    86    58    57    26    51
    319  1341]
 [  159    39    22    13    14    21    18    40    22    16    16    16
     41   177]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0
      0     0]]
/m100/home/userexternal/mmalucch/weaver/utils/data/preprocess.py:190: RuntimeWarning: divide by zero encountered in true_divide
  wgt = np.clip(np.nan_to_num(ref_val / hist, posinf=0), 0, 1)
[2022-11-30 13:06:51,856] INFO: weights:
[2022-11-30 13:06:51,858] INFO: label_catB:
 [[0.17693993 0.11569149 0.11140662 0.05371391 0.04774569 0.04064836
  0.03538799 0.02734526 0.03580927 0.03624071 0.06266623 0.08129672
  0.11140662 0.23138298]
 [0.09703157 0.09399933 0.07712767 0.04774569 0.03668267 0.03342199
  0.02179695 0.02615634 0.02661928 0.03418158 0.06399955 0.09399933
  0.08594225 0.08846997]
 [0.09703157 0.11569149 0.11569149 0.05098269 0.03807568 0.02046244
  0.01891811 0.01940631 0.02527713 0.03101009 0.04297113 0.06684397
  0.14323708 0.13078168]
 [0.23138298 0.15039892 0.07915734 0.04774569 0.02785166 0.01790464
  0.01812035 0.01940631 0.01856777 0.03199977 0.05013298 0.07519946
  0.12533246 0.20053191]
 [0.23138298 0.20053191 0.08355496 0.04851579 0.02785166 0.01709079
  0.01467307 0.01392583 0.01779869 0.02709891 0.04489521 0.08129672
  0.15039892 0.21485563]
 [0.23138298 0.23138298 0.12031914 0.0349765  0.02638578 0.01879987
  0.01198398 0.01208024 0.01652736 0.02331766 0.0518617  0.10742781
  0.23138298 0.23138298]
 [0.23138298 0.23138298 0.09703157 0.04931113 0.02074468 0.01405598
  0.01184244 0.01188924 0.01336879 0.02527713 0.0462766  0.17693993
  0.17693993 0.23138298]
 [0.         0.23138298 0.09703157 0.03538799 0.01834133 0.01307817
  0.00849712 0.01070455 0.01148084 0.02118295 0.04120519 0.09399933
  0.23138298 0.23138298]
 [0.         0.23138298 0.10026596 0.03457447 0.01812035 0.01126584
  0.00833235 0.00828644 0.01126584 0.01903784 0.03807568 0.18799867
  0.23138298 0.23138298]
 [0.         0.23138298 0.10026596 0.02759613 0.01652736 0.00869358
  0.00723072 0.00733653 0.00908755 0.01558538 0.04177748 0.11140662
  0.23138298 0.        ]
 [0.         0.         0.12031914 0.04177748 0.01617193 0.00849712
  0.005898   0.00688325 0.00892575 0.01718845 0.03624071 0.14323708
  0.23138298 0.        ]
 [0.         0.         0.23138298 0.05469052 0.01418858 0.00765389
  0.00602801 0.00598008 0.00847318 0.01446144 0.0423659  0.23138298
  0.23138298 0.        ]
 [0.         0.23138298 0.23138298 0.04931113 0.01534683 0.00842571
  0.00549905 0.00550912 0.00721338 0.01718845 0.05570331 0.23138298
  0.         0.        ]
 [0.         0.         0.23138298 0.07712767 0.01348869 0.0065249
  0.00456446 0.00412617 0.00617655 0.01550504 0.05570331 0.23138298
  0.23138298 0.        ]
 [0.         0.         0.23138298 0.07915734 0.0139906  0.00479741
  0.00324136 0.00313658 0.00443001 0.01237851 0.10742781 0.23138298
  0.         0.        ]]
[2022-11-30 13:06:51,861] INFO: label_catC:
 [[0.02905369 0.03520624 0.02933853 0.02473165 0.0196877  0.01466926
  0.01600283 0.01354086 0.01739843 0.01847241 0.02671902 0.03053602
  0.03400602 0.02962901]
 [0.02432951 0.04337    0.03740662 0.02962901 0.02413331 0.02122362
  0.01710017 0.01653332 0.01710017 0.02035735 0.0274544  0.04337
  0.03520624 0.02319791]
 [0.02557718 0.04337    0.03836577 0.026022   0.01894006 0.01474153
  0.01241714 0.01341942 0.01600283 0.01955902 0.026022   0.04214831
  0.04099356 0.02452893]
 [0.04603892 0.04905787 0.04603892 0.0325275  0.02137521 0.01459771
  0.01330013 0.01404944 0.0156677  0.02137521 0.02933853 0.04400779
  0.06959372 0.04603892]
 [0.08087919 0.05343804 0.04675828 0.03117219 0.01835908 0.01360241
  0.01104255 0.01142187 0.01360241 0.01894006 0.03085082 0.05159535
  0.07673154 0.06959372]
 [0.10075858 0.09653322 0.06234438 0.03117219 0.0202198  0.01496265
  0.01129257 0.00990904 0.01295468 0.02035735 0.02877433 0.06234438
  0.08550086 0.10075858]
 [0.10075858 0.10075858 0.06234438 0.02720482 0.01824713 0.01226447
  0.0095608  0.01042693 0.01231494 0.01791934 0.03150031 0.05541722
  0.10075858 0.10075858]
 [0.10075858 0.10075858 0.06801204 0.0325275  0.01770728 0.01014417
  0.00885364 0.00833574 0.00974766 0.01503784 0.02850028 0.05754865
  0.10075858 0.10075858]
 [0.10075858 0.10075858 0.07673154 0.02536042 0.01488821 0.00981157
  0.00759525 0.00767315 0.00915147 0.01608887 0.02356323 0.06801204
  0.10075858 0.10075858]
 [0.10075858 0.10075858 0.10075858 0.03288494 0.01341942 0.00838244
  0.0061072  0.00687938 0.00785441 0.01324128 0.03439689 0.06801204
  0.10075858 0.10075858]
 [0.10075858 0.10075858 0.10075858 0.0299253  0.01452684 0.00767315
  0.00631335 0.00660603 0.00802287 0.01411571 0.03117219 0.10075858
  0.10075858 0.        ]
 [0.         0.10075858 0.10075858 0.03520624 0.01318295 0.00817631
  0.00602119 0.00567843 0.00798008 0.01608887 0.03325033 0.10075858
  0.10075858 0.        ]
 [0.         0.         0.10075858 0.04603892 0.01466926 0.00695937
  0.00563565 0.00559351 0.0070913  0.01481451 0.04905787 0.10075858
  0.         0.        ]
 [0.         0.         0.10075858 0.05754865 0.01289884 0.00636708
  0.00458977 0.00473502 0.00662064 0.01318295 0.0498755  0.10075858
  0.10075858 0.        ]
 [0.         0.         0.10075858 0.06367085 0.01268021 0.00492192
  0.00316335 0.00346358 0.00494633 0.01318295 0.065055   0.10075858
  0.         0.        ]]
[2022-11-30 13:06:51,863] INFO: label_uds:
 [[0.00919996 0.02163085 0.03119299 0.02577293 0.02438915 0.0227836
  0.02058914 0.02137637 0.02064763 0.0248903  0.02506195 0.02850183
  0.02189147 0.0099972 ]
 [0.0068308  0.0238294  0.03765786 0.03825245 0.03785399 0.03349293
  0.02732318 0.02614377 0.03015754 0.03477496 0.04060316 0.03580279
  0.02595702 0.00685657]
 [0.00604656 0.02506195 0.03215914 0.03444534 0.03132744 0.02895604
  0.02753017 0.02722085 0.03053767 0.03244628 0.03273859 0.03708147
  0.02463718 0.00626549]
 [0.00824032 0.02763486 0.03303621 0.03785399 0.03528139 0.03615904
  0.02828003 0.03053767 0.03259178 0.03598003 0.03511095 0.03364799
  0.02763486 0.00773188]
 [0.01081543 0.02806165 0.03364799 0.04124839 0.03215914 0.03303621
  0.02763486 0.02753017 0.03146306 0.03079647 0.04083127 0.03511095
  0.02480535 0.01076736]
 [0.01579993 0.02918862 0.0283905  0.03215914 0.02954458 0.02497583
  0.02271239 0.02472097 0.02895604 0.03288673 0.03689323 0.03053767
  0.02681907 0.01427891]
 [0.02118941 0.02732318 0.02497583 0.02954458 0.02497583 0.02307291
  0.01985783 0.02070646 0.02307291 0.02930632 0.02681907 0.02514867
  0.02966517 0.02250144]
 [0.03273859 0.03396246 0.02784662 0.0238294  0.02118941 0.01938124
  0.01759798 0.01897641 0.02076562 0.02285524 0.02406611 0.02662259
  0.03949982 0.03615904]
 [0.04124839 0.04060316 0.02990933 0.02577293 0.02150286 0.01678514
  0.01618701 0.01536568 0.01807952 0.02169542 0.0222262  0.02806165
  0.04124839 0.04124839]
 [0.04124839 0.04124839 0.03288673 0.02236297 0.0179456  0.0149855
  0.01277323 0.01389669 0.0149855  0.018927   0.02322034 0.03708147
  0.04124839 0.04124839]
 [0.04124839 0.04124839 0.04124839 0.02215843 0.01615104 0.01442057
  0.01272849 0.01166608 0.01338484 0.01887784 0.02541247 0.04124839
  0.04124839 0.04124839]
 [0.         0.04124839 0.04124839 0.02681907 0.01714143 0.01284093
  0.01142762 0.01132082 0.01293232 0.01785741 0.03092752 0.04124839
  0.04124839 0.04124839]
 [0.         0.04124839 0.04124839 0.03949982 0.02100568 0.01316661
  0.01076736 0.01065684 0.01281828 0.022432   0.04060316 0.04124839
  0.04124839 0.04124839]
 [0.         0.04124839 0.04124839 0.04124839 0.02614377 0.01253098
  0.00975566 0.00958835 0.0123395  0.02414607 0.04124839 0.04124839
  0.         0.        ]
 [0.         0.         0.04124839 0.04124839 0.02806165 0.01113012
  0.00817544 0.00800437 0.01203306 0.02541247 0.04124839 0.04124839
  0.         0.        ]]
[2022-11-30 13:06:51,865] INFO: label_g:
 [[0.00862528 0.00976616 0.01160709 0.00870532 0.00861596 0.0079661
  0.00817434 0.00832801 0.00808319 0.00847404 0.00917614 0.01154825
  0.0098567  0.00896971]
 [0.00747686 0.0122678  0.01452472 0.01136717 0.0104853  0.01022317
  0.01014513 0.01004291 0.01026264 0.01006827 0.0119641  0.01436769
  0.01217415 0.00696425]
 [0.00849209 0.01384387 0.01571245 0.01277896 0.01105974 0.01140782
  0.01051295 0.01067479 0.01016452 0.01152322 0.01267738 0.0158846
  0.01539396 0.00845607]
 [0.01869653 0.0252344  0.02169815 0.01599613 0.01460452 0.01302953
  0.01367765 0.0133681  0.01379597 0.0131694  0.01718549 0.02187674
  0.02873539 0.01781915]
 [0.03632834 0.03788156 0.02464936 0.01891831 0.01656089 0.01483548
  0.01429045 0.01427765 0.01486313 0.01610923 0.01988546 0.02593193
  0.04099778 0.03928113]
 [0.08178533 0.06133899 0.04185863 0.02684872 0.01968906 0.01773986
  0.01639069 0.01865279 0.01773986 0.02049889 0.0247258  0.0370887
  0.07119705 0.0755836 ]
 [0.19935173 0.10223167 0.0528084  0.03127086 0.02205828 0.01912247
  0.01952036 0.01858757 0.01896331 0.02236766 0.03301892 0.05177967
  0.10703449 0.20711868]
 [0.26803595 0.19214624 0.08714829 0.04264208 0.0286322  0.02355707
  0.02084724 0.02221189 0.02208884 0.0286322  0.03937812 0.08438168
  0.1898588  0.26803595]
 [0.26803595 0.26803595 0.12861402 0.06110398 0.0364946  0.02858089
  0.02754428 0.02576436 0.03274772 0.03937812 0.06874198 0.1423941
  0.26803595 0.26803595]
 [0.26803595 0.26803595 0.26803595 0.09436769 0.05111583 0.03497399
  0.03505086 0.03120967 0.03666238 0.05635385 0.09665539 0.20187517
  0.26803595 0.26803595]
 [0.         0.26803595 0.26803595 0.13989595 0.08136806 0.05194834
  0.04345542 0.04492434 0.05406149 0.09607312 0.1898588  0.26803595
  0.26803595 0.        ]
 [0.         0.26803595 0.26803595 0.26803595 0.12657253 0.07594351
  0.05950798 0.06229742 0.06536122 0.14367692 0.26803595 0.26803595
  0.         0.        ]
 [0.         0.         0.26803595 0.26803595 0.26803595 0.12081923
  0.08860077 0.0949294  0.13401797 0.24918967 0.26803595 0.26803595
  0.         0.        ]
 [0.         0.         0.         0.26803595 0.26803595 0.24535598
  0.16273612 0.16787514 0.26803595 0.26803595 0.26803595 0.
  0.         0.        ]
 [0.         0.         0.         0.26803595 0.26803595 0.26803595
  0.26803595 0.26803595 0.26803595 0.26803595 0.26803595 0.26803595
  0.         0.        ]]
[2022-11-30 13:06:51,868] INFO: label_undef:
 [[0.12857144 0.1        0.15       0.17999999 0.08181819 0.08181819
  0.04090909 0.05294118 0.075      0.1        0.12857144 0.3
  0.08181819 0.06923077]
 [0.1        0.15       0.45       0.3        0.45       0.05625
  0.06       0.05625    0.09       0.225      0.9        0.9
  0.15       0.1125    ]
 [0.12857144 0.9        0.9        0.         0.9        0.12857144
  0.1        0.1125     0.45       0.45       0.         0.45
  0.45       0.225     ]
 [0.9        0.         0.         0.         0.45       0.9
  0.225      0.225      0.225      0.225      0.         0.9
  0.45       0.12857144]
 [0.45       0.9        0.         0.225      0.45       0.9
  0.3        0.45       0.3        0.9        0.45       0.45
  0.         0.        ]
 [0.         0.9        0.45       0.         0.9        0.3
  0.45       0.9        0.45       0.45       0.         0.9
  0.9        0.        ]
 [0.9        0.         0.45       0.         0.9        0.9
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.9        0.         0.         0.9        0.9        0.
  0.3        0.45       0.3        0.         0.9        0.
  0.         0.        ]
 [0.         0.         0.         0.45       0.         0.
  0.         0.9        0.9        0.9        0.         0.
  0.9        0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
[2022-11-30 13:06:51,870] INFO: label_pu:
 [[0.00034155 0.00028543 0.00226477 0.00203916 0.00156689 0.00144099
  0.0013151  0.00128269 0.00138197 0.00138751 0.00208781 0.00225005
  0.00029542 0.00034569]
 [0.00036685 0.00072874 0.01014385 0.01047753 0.00685867 0.00575355
  0.00478829 0.0046431  0.00554135 0.00644249 0.00952502 0.00913179
  0.00076892 0.00035851]
 [0.00081915 0.00288303 0.03636036 0.05071923 0.03603131 0.02134831
  0.0199073  0.01694238 0.02243076 0.03135008 0.04945913 0.04062714
  0.00300828 0.00080784]
 [0.00582511 0.02321551 0.17310695 0.24501291 0.13970034 0.10341454
  0.12442062 0.09259209 0.13729171 0.13970034 0.24501291 0.15613568
  0.02496213 0.00593805]
 [0.05008126 0.20417742 0.24501291 0.24501291 0.24501291 0.24501291
  0.24501291 0.19907299 0.24501291 0.24501291 0.24501291 0.24501291
  0.19421755 0.04498824]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
[2022-11-30 13:06:51,870] INFO: Raw hist * weights:
[2022-11-30 13:06:51,871] INFO: label_catB:
 [[3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [2 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 2 3 3 3 3 3 3 3 3 3 3 2 2]
 [0 1 3 3 3 3 3 3 3 3 3 3 3 0]
 [0 1 3 3 3 3 3 3 3 3 3 3 1 0]
 [0 1 3 3 3 3 3 3 3 3 3 3 0 0]
 [0 0 3 3 3 3 3 3 3 3 3 3 0 0]
 [0 0 3 3 3 3 3 3 3 3 3 3 0 0]
 [0 0 2 3 3 3 3 3 3 3 3 1 0 0]
 [0 0 1 3 3 3 3 3 3 3 3 2 0 0]
 [0 0 0 3 3 3 3 3 3 3 3 0 0 0]
 [0 0 0 3 3 3 3 3 3 3 3 1 0 0]]
[2022-11-30 13:06:51,872] INFO: label_catC:
 [[2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 1]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 1]
 [0 1 2 2 2 2 2 2 2 2 2 2 2 0]
 [0 1 2 2 2 2 2 2 2 2 2 2 1 0]
 [0 0 2 2 2 2 2 2 2 2 2 2 0 0]
 [0 0 2 2 2 2 2 2 2 2 2 2 0 0]
 [0 0 1 2 2 2 2 2 2 2 2 2 0 0]
 [0 0 0 2 2 2 2 2 2 2 2 1 0 0]
 [0 0 0 2 2 2 2 2 2 2 2 0 0 0]
 [0 0 0 2 2 2 2 2 2 2 2 0 0 0]]
[2022-11-30 13:06:51,873] INFO: label_uds:
 [[7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [4 7 7 7 7 7 7 7 7 7 7 7 6 4]
 [1 4 7 7 7 7 7 7 7 7 7 7 4 1]
 [0 2 7 7 7 7 7 7 7 7 7 6 1 0]
 [0 0 4 7 7 7 7 7 7 7 7 4 1 0]
 [0 0 1 7 7 7 7 7 7 7 7 1 0 0]
 [0 0 0 4 7 7 7 7 7 7 5 0 0 0]
 [0 0 0 2 7 7 7 7 7 7 2 0 0 0]]
[2022-11-30 13:06:51,874] INFO: label_g:
 [[15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [15 15 15 15 15 15 15 15 15 15 15 15 15 15]
 [ 7 15 15 15 15 15 15 15 15 15 15 15 15  6]
 [ 1 10 15 15 15 15 15 15 15 15 15 15  8  2]
 [ 1  2 14 15 15 15 15 15 15 15 15 15  2  0]
 [ 0  1  7 15 15 15 15 15 15 15 15  6  1  0]
 [ 0  0  1 11 15 15 15 15 15 15 14  1  0  0]
 [ 0  0  0  3 12 15 15 15 15 15  4  1  0  0]
 [ 0  0  0  0  5 15 15 15 14  6  1  0  0  0]
 [ 0  0  0  1  2  6 14 11  8  1  0  0  0  0]]
[2022-11-30 13:06:51,875] INFO: label_undef:
 [[0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]]
[2022-11-30 13:06:51,876] INFO: label_pu:
 [[7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 7 7 7 7]
 [7 7 7 7 7 7 7 7 7 7 6 7 7 7]
 [7 7 5 3 3 5 4 7 5 3 3 3 7 7]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0]]
[2022-11-30 13:06:51,876] INFO: Writing YAML file w/ reweighting info to data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml
[2022-11-30 13:06:51,962] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 13:06:52,152] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 13:06:52,152] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 13:06:52,152] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 13:06:52,152] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 13:06:52,152] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 13:06:52,152] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 13:06:52,153] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 13:06:52,153] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 13:06:52,153] INFO: label_names: ('_label_',)
[2022-11-30 13:06:52,153] INFO: observer_names: ()
[2022-11-30 13:06:52,153] INFO: monitor_variables: ()
[2022-11-30 13:06:52,153] INFO: reweight_method: flat
[2022-11-30 13:06:52,153] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 13:06:52,153] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 13:06:52,153] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 13:06:52,154] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 13:06:52,154] INFO: reweight_threshold: 15
[2022-11-30 13:06:52,154] INFO: reweight_discard_under_overflow: True
[2022-11-30 13:06:52,156] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 13:06:52,344] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 13:06:52,344] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 13:06:52,344] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 13:06:52,344] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 13:06:52,344] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 13:06:52,344] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 13:06:52,344] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 13:06:52,345] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 13:06:52,345] INFO: label_names: ('_label_',)
[2022-11-30 13:06:52,345] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 13:06:52,345] INFO: monitor_variables: ()
[2022-11-30 13:06:52,345] INFO: reweight_method: flat
[2022-11-30 13:06:52,345] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 13:06:52,345] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 13:06:52,345] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 13:06:52,345] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 13:06:52,345] INFO: reweight_threshold: 15
[2022-11-30 13:06:52,345] INFO: reweight_discard_under_overflow: True
[2022-11-30 13:06:52,535] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 13:06:52,535] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 13:06:52,536] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 13:06:52,536] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 13:06:52,536] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 13:06:52,536] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 13:06:52,536] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 13:06:52,536] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 13:06:52,536] INFO: label_names: ('_label_',)
[2022-11-30 13:06:52,536] INFO: observer_names: ()
[2022-11-30 13:06:52,537] INFO: monitor_variables: ()
[2022-11-30 13:06:52,537] INFO: reweight_method: flat
[2022-11-30 13:06:52,537] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 13:06:52,537] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 13:06:52,537] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 13:06:52,537] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 13:06:52,537] INFO: reweight_threshold: 15
[2022-11-30 13:06:52,537] INFO: reweight_discard_under_overflow: True
[2022-11-30 13:06:52,557] INFO: Network options: {}
[2022-11-30 13:06:52,617] INFO: Warning: module FeatureConv is treated as a zero-op.
[2022-11-30 13:06:52,617] INFO: Warning: module EdgeConvBlock is treated as a zero-op.
[2022-11-30 13:06:52,618] INFO: Warning: module Dropout is treated as a zero-op.
[2022-11-30 13:06:52,618] INFO: Warning: module ParticleNet is treated as a zero-op.
[2022-11-30 13:06:52,618] INFO: Warning: module ParticleNetTagger is treated as a zero-op.
[2022-11-30 13:06:53,520] INFO: ParticleNetTagger(
  |0.579 M, 100.000% Params, 242.737 MMac, 100.000% MACs|
  (pf_conv): FeatureConv(
    |0.001 M, 0.128% Params, 38.8 KMac, 0.016% MACs|
    (conv): Sequential(
      |0.001 M, 0.128% Params, 38.8 KMac, 0.016% MACs|
      (0): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 2.0 KMac, 0.001% MACs|)
      (1): Conv1d(20, 32, kernel_size=(1,), stride=(1,), bias=False, |0.001 M, 0.110% Params, 32.0 KMac, 0.013% MACs|)
      (2): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.011% Params, 3.2 KMac, 0.001% MACs|)
      (3): ReLU(|0.0 M, 0.000% Params, 1.6 KMac, 0.001% MACs|)
    )
  )
  (sv_conv): FeatureConv(
    |0.0 M, 0.076% Params, 2.35 KMac, 0.001% MACs|
    (conv): Sequential(
      |0.0 M, 0.076% Params, 2.35 KMac, 0.001% MACs|
      (0): BatchNorm1d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.004% Params, 110.0 Mac, 0.000% MACs|)
      (1): Conv1d(11, 32, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.061% Params, 1.76 KMac, 0.001% MACs|)
      (2): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.011% Params, 320.0 Mac, 0.000% MACs|)
      (3): ReLU(|0.0 M, 0.000% Params, 160.0 Mac, 0.000% MACs|)
    )
  )
  (pn): ParticleNet(
    |0.578 M, 99.796% Params, 242.696 MMac, 99.983% MACs|
    (edge_convs): ModuleList(
      |0.305 M, 52.593% Params, 233.07 MMac, 96.017% MACs|
      (0): EdgeConvBlock(
        |0.015 M, 2.563% Params, 11.444 MMac, 4.714% MACs|
        (convs): ModuleList(
          |0.012 M, 2.121% Params, 10.813 MMac, 4.455% MACs|
          (0): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
          (1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
          (2): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
        )
        (bns): ModuleList(
          |0.0 M, 0.066% Params, 337.92 KMac, 0.139% MACs|
          (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
          (2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 168.96 KMac, 0.070% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
        )
        (sc): Conv1d(32, 64, kernel_size=(1,), stride=(1,), bias=False, |0.002 M, 0.354% Params, 112.64 KMac, 0.046% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 7.04 KMac, 0.003% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.52 KMac, 0.001% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 10.077% Params, 44.739 MMac, 18.431% MACs|
        (convs): ModuleList(
          |0.049 M, 8.486% Params, 43.254 MMac, 17.819% MACs|
          (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
          (1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
          (2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
        )
        (bns): ModuleList(
          |0.001 M, 0.133% Params, 675.84 KMac, 0.278% MACs|
          (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
          (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
          (2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 337.92 KMac, 0.139% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 1.414% Params, 450.56 KMac, 0.186% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 14.08 KMac, 0.006% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 7.04 KMac, 0.003% MACs|)
      )
      (2): EdgeConvBlock(
        |0.231 M, 39.953% Params, 176.887 MMac, 72.872% MACs|
        (convs): ModuleList(
          |0.197 M, 33.943% Params, 173.015 MMac, 71.277% MACs|
          (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
          (1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
          (2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
        )
        (bns): ModuleList(
          |0.002 M, 0.265% Params, 1.352 MMac, 0.557% MACs|
          (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
          (2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 675.84 KMac, 0.278% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
        )
        (sc): Conv1d(128, 256, kernel_size=(1,), stride=(1,), bias=False, |0.033 M, 5.657% Params, 1.802 MMac, 0.742% MACs|)
        (sc_bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 28.16 KMac, 0.012% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 14.08 KMac, 0.006% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.173 M, 29.832% Params, 9.525 MMac, 3.924% MACs|
      (0): Conv1d(448, 384, kernel_size=(1,), stride=(1,), bias=False, |0.172 M, 29.700% Params, 9.462 MMac, 3.898% MACs|)
      (1): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.133% Params, 42.24 KMac, 0.017% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 21.12 KMac, 0.009% MACs|)
    )
    (fc): Sequential(
      |0.101 M, 17.370% Params, 100.872 KMac, 0.042% MACs|
      (0): Sequential(
        |0.099 M, 17.015% Params, 98.816 KMac, 0.041% MACs|
        (0): Linear(in_features=384, out_features=256, bias=True, |0.099 M, 17.015% Params, 98.56 KMac, 0.041% MACs|)
        (1): ReLU(|0.0 M, 0.000% Params, 256.0 Mac, 0.000% MACs|)
        (2): Dropout(p=0.1, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
      (1): Linear(in_features=256, out_features=8, bias=True, |0.002 M, 0.355% Params, 2.056 KMac, 0.001% MACs|)
    )
  )
)
[2022-11-30 13:06:53,523] INFO: Computational complexity:       242.74 MMac
[2022-11-30 13:06:53,523] INFO: Number of parameters:           579.24 k
[2022-11-30 13:06:53,524] INFO: Using loss function CrossEntropyLoss() with options {}
[2022-11-30 13:06:55,073] INFO: Optimizer options: {}
[2022-11-30 13:06:55,078] INFO: --------------------------------------------------
[2022-11-30 13:06:55,079] INFO: Epoch #0 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=3184498226 ===
[2022-11-30 13:06:55,108] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
86it [01:00,  1.41it/s, lr=5.00e-03, Loss=1.27938, AvgLoss=1.48320, Acc=0.55859, AvgAcc=0.46911]
[2022-11-30 13:07:55,902] INFO: Processed 44032 entries in total (avg. speed 723.9 entries/s)
[2022-11-30 13:07:55,902] INFO: Train AvgLoss: 1.48320, AvgAcc: 0.46911
[2022-11-30 13:07:55,902] INFO: Train class distribution: 
    [(0, 3424), (1, 850), (2, 3217), (3, 1060), (4, 10413), (5, 20352), (6, 623), (7, 4093)]
[2022-11-30 13:07:56,202] INFO: Epoch #0 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=3816738494 ===
[2022-11-30 13:07:56,228] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
21it [00:12,  1.64it/s, Loss=1.30039, AvgLoss=1.21084, Acc=0.55273, AvgAcc=0.57403]
[2022-11-30 13:08:09,046] INFO: Processed 10752 entries in total (avg. speed 837.2 entries/s)
[2022-11-30 13:08:09,046] INFO: Evaluation class distribution: 
    [(0, 754), (1, 187), (2, 730), (3, 216), (4, 2530), (5, 5186), (6, 146), (7, 1003)]
[2022-11-30 13:08:09,299] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.7251043361099399
    - roc_auc_score_matrix: 
[[0.         0.7609895  0.71338975 0.6875798  0.8130188  0.8348387
  0.83449906 0.90402   ]
 [0.         0.         0.88449925 0.8050851  0.927465   0.934874
  0.9807706  0.975352  ]
 [0.         0.         0.         0.6666286  0.62385726 0.7222856
  0.87416023 0.9341468 ]
 [0.         0.         0.         0.         0.7771226  0.73290265
  0.93296546 0.9617905 ]
 [0.         0.         0.         0.         0.         0.7474059
  0.8782094  0.94237125]
 [0.         0.         0.         0.         0.         0.
  0.91164565 0.9474596 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.6940753 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[0.22281167 0.         0.         0.         0.07824934 0.65251989
  0.         0.0464191 ]
 [0.32085561 0.         0.         0.         0.07486631 0.60427807
  0.         0.        ]
 [0.03972603 0.         0.         0.         0.20821918 0.73561644
  0.         0.01643836]
 [0.05092593 0.         0.         0.         0.09259259 0.85648148
  0.         0.        ]
 [0.00988142 0.         0.         0.         0.25968379 0.71067194
  0.         0.01976285]
 [0.00385654 0.         0.         0.         0.05167759 0.93251061
  0.         0.01195526]
 [0.10273973 0.         0.         0.         0.09589041 0.45890411
  0.         0.34246575]
 [0.03090728 0.         0.         0.         0.01395813 0.44566301
  0.         0.50947159]]
[2022-11-30 13:08:09,394] INFO: Epoch #0: Current validation metric: 0.57403 (best: 0.57403)
[2022-11-30 13:08:09,394] INFO: --------------------------------------------------
[2022-11-30 13:08:09,394] INFO: Epoch #1 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=4293083601 ===
[2022-11-30 13:08:09,415] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
87it [00:50,  1.71it/s, lr=5.00e-03, Loss=1.10139, AvgLoss=1.14740, Acc=0.61914, AvgAcc=0.58758]
[2022-11-30 13:09:00,265] INFO: Processed 44544 entries in total (avg. speed 875.6 entries/s)
[2022-11-30 13:09:00,265] INFO: Train AvgLoss: 1.14740, AvgAcc: 0.58758
[2022-11-30 13:09:00,266] INFO: Train class distribution: 
    [(0, 3379), (1, 772), (2, 3160), (3, 1011), (4, 10613), (5, 20793), (6, 632), (7, 4184)]
[2022-11-30 13:09:00,323] INFO: Epoch #1 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=1614456657 ===
[2022-11-30 13:09:00,344] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
22it [00:12,  1.73it/s, Loss=1.20226, AvgLoss=1.13763, Acc=0.56445, AvgAcc=0.59286]
[2022-11-30 13:09:13,019] INFO: Processed 11264 entries in total (avg. speed 887.2 entries/s)
[2022-11-30 13:09:13,020] INFO: Evaluation class distribution: 
    [(0, 791), (1, 174), (2, 825), (3, 236), (4, 2597), (5, 5406), (6, 156), (7, 1079)]
[2022-11-30 13:09:13,183] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.7821625230875083
    - roc_auc_score_matrix: 
[[0.         0.80948746 0.7881883  0.80822384 0.9015357  0.9069807
  0.90674734 0.9522372 ]
 [0.         0.         0.90788573 0.86150885 0.9716184  0.9662869
  0.982206   0.9915364 ]
 [0.         0.         0.         0.7079661  0.7002408  0.7452924
  0.90393937 0.9493695 ]
 [0.         0.         0.         0.         0.81447625 0.749086
  0.9655041  0.97215325]
 [0.         0.         0.         0.         0.         0.76219034
  0.902412   0.95483345]
 [0.         0.         0.         0.         0.         0.
  0.9317413  0.95924973]
 [0.         0.         0.         0.         0.         0.
  0.         0.74204504]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[4.75347661e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.12515803e-01 3.98230088e-01 0.00000000e+00 1.39064475e-02]
 [6.03448276e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  7.47126437e-02 3.21839080e-01 0.00000000e+00 0.00000000e+00]
 [1.20000000e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  3.07878788e-01 5.66060606e-01 0.00000000e+00 6.06060606e-03]
 [8.47457627e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.35593220e-01 7.79661017e-01 0.00000000e+00 0.00000000e+00]
 [1.23219099e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  4.84020023e-01 4.94801694e-01 3.85059684e-04 8.47131305e-03]
 [5.73436922e-03 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.45394007e-01 8.42952275e-01 1.10987791e-03 4.80947096e-03]
 [7.05128205e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  2.69230769e-01 3.58974359e-01 1.73076923e-01 1.28205128e-01]
 [3.05838740e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  9.91658943e-02 4.26320667e-01 1.66821131e-02 4.27247451e-01]]
[2022-11-30 13:09:13,233] INFO: Epoch #1: Current validation metric: 0.59286 (best: 0.59286)
[2022-11-30 13:09:13,234] INFO: --------------------------------------------------
[2022-11-30 13:09:13,234] INFO: Epoch #2 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=2976476122 ===
[2022-11-30 13:09:13,255] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
87it [00:50,  1.71it/s, lr=5.00e-05, Loss=1.19054, AvgLoss=1.09295, Acc=0.59766, AvgAcc=0.60637]
[2022-11-30 13:10:04,059] INFO: Processed 44544 entries in total (avg. speed 876.4 entries/s)
[2022-11-30 13:10:04,059] INFO: Train AvgLoss: 1.09295, AvgAcc: 0.60637
[2022-11-30 13:10:04,059] INFO: Train class distribution: 
    [(0, 3524), (1, 862), (2, 3185), (3, 1079), (4, 10388), (5, 20686), (6, 651), (7, 4169)]
[2022-11-30 13:10:04,264] INFO: Epoch #2 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=3048713951 ===
[2022-11-30 13:10:04,285] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
21it [00:12,  1.69it/s, Loss=1.16321, AvgLoss=1.06394, Acc=0.57031, AvgAcc=0.61849]
[2022-11-30 13:10:16,710] INFO: Processed 10752 entries in total (avg. speed 863.9 entries/s)
[2022-11-30 13:10:16,711] INFO: Evaluation class distribution: 
    [(0, 726), (1, 151), (2, 683), (3, 245), (4, 2521), (5, 5211), (6, 155), (7, 1060)]
[2022-11-30 13:10:16,869] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.8048922107274448
    - roc_auc_score_matrix: 
[[0.         0.83680874 0.77046245 0.7627199  0.89942986 0.89545316
  0.9121212  0.95005715]
 [0.         0.         0.9133643  0.84357345 0.9732131  0.9717891
  0.9852168  0.99447703]
 [0.         0.         0.         0.7193773  0.71679705 0.7419568
  0.9207292  0.94747645]
 [0.         0.         0.         0.         0.8423447  0.8015407
  0.96086895 0.9744166 ]
 [0.         0.         0.         0.         0.         0.7786586
  0.91781294 0.9569709 ]
 [0.         0.         0.         0.         0.         0.
  0.94332457 0.9571099 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.83969563]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[4.68319559e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  7.30027548e-02 4.04958678e-01 0.00000000e+00 5.37190083e-02]
 [6.62251656e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  5.96026490e-02 2.78145695e-01 0.00000000e+00 0.00000000e+00]
 [1.24450952e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  2.15226940e-01 6.29575403e-01 0.00000000e+00 3.07467057e-02]
 [1.83673469e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.22448980e-01 6.81632653e-01 0.00000000e+00 1.22448980e-02]
 [1.66600555e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  3.98254661e-01 5.50971837e-01 7.93335978e-04 3.33201111e-02]
 [8.63557858e-03 0.00000000e+00 0.00000000e+00 0.00000000e+00
  8.15582422e-02 8.80445212e-01 5.75705239e-04 2.87852619e-02]
 [5.16129032e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  2.00000000e-01 2.96774194e-01 6.45161290e-02 3.87096774e-01]
 [1.13207547e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  2.07547170e-02 2.93396226e-01 6.60377358e-03 6.67924528e-01]]
[2022-11-30 13:10:16,922] INFO: Epoch #2: Current validation metric: 0.61849 (best: 0.61849)
[2022-11-30 13:10:16,922] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 13:10:17,111] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 13:10:17,111] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 13:10:17,111] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 13:10:17,111] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 13:10:17,111] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 13:10:17,111] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 13:10:17,111] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 13:10:17,112] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 13:10:17,112] INFO: label_names: ('_label_',)
[2022-11-30 13:10:17,112] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 13:10:17,112] INFO: monitor_variables: ()
[2022-11-30 13:10:17,112] INFO: reweight_method: flat
[2022-11-30 13:10:17,112] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 13:10:17,112] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 13:10:17,112] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 13:10:17,112] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 13:10:17,113] INFO: reweight_threshold: 15
[2022-11-30 13:10:17,113] INFO: reweight_discard_under_overflow: True
[2022-11-30 13:10:17,117] INFO: Loading model models_3/_best_epoch_state.pt for eval
[2022-11-30 13:10:17,139] INFO: Running on test file group  with 1 files:
.../m100_work/INF22_lhc_0/mmalucch/output_149.root
[2022-11-30 13:10:17,139] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 13:10:17,328] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 13:10:17,329] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 13:10:17,329] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 13:10:17,329] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 13:10:17,329] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 13:10:17,329] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 13:10:17,329] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 13:10:17,329] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 13:10:17,329] INFO: label_names: ('_label_',)
[2022-11-30 13:10:17,330] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 13:10:17,330] INFO: monitor_variables: ()
[2022-11-30 13:10:17,330] INFO: reweight_method: flat
[2022-11-30 13:10:17,330] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 13:10:17,330] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 13:10:17,330] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 13:10:17,330] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 13:10:17,330] INFO: reweight_threshold: 15
[2022-11-30 13:10:17,330] INFO: reweight_discard_under_overflow: True
0it [00:00, ?it/s]=== Restarting DataIter test__worker0, seed=1532026938 ===
[2022-11-30 13:10:17,353] INFO: Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/m100_work/INF22_lhc_0/mmalucch/output_149.root"
  ]
}
[2022-11-30 13:10:17,540] ERROR: When reading file /m100_work/INF22_lhc_0/mmalucch/output_149.root:
[2022-11-30 13:10:17,574] ERROR: Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 414, in get
    return self._branchlookup[name]
KeyError: b'jet_matched_genjet_pt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/weaver/utils/data/fileio.py", line 76, in _read_files
    a = _read_root(filepath, branches, load_range=load_range, treename=kwargs.get('treename', None))
  File "/m100/home/userexternal/mmalucch/weaver/utils/data/fileio.py", line 45, in _read_root
    outputs = tree.arrays(branches, namedecode='utf-8', entrystart=start, entrystop=stop)
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 537, in arrays
    branches = list(self._normalize_branches(branches, awkward0))
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 892, in _normalize_branches
    branch = self.get(word, aliases=aliases)
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 416, in get
    return self._get(name, recursive, filtername, filtertitle, aliases)
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 409, in _get
    raise uproot3.rootio._KeyError("not found: {0}\n in file: {1}".format(repr(name), self._context.sourcepath))
_KeyError: not found: b'jet_matched_genjet_pt'
 in file: /m100_work/INF22_lhc_0/mmalucch/output_149.root

0it [00:00, ?it/s]
Traceback (most recent call last):
  File "train.py", line 889, in <module>
    main(args)
  File "train.py", line 821, in main
    test_metric, scores, labels, observers = evaluate(
  File "/m100/home/userexternal/mmalucch/weaver/utils/nn/tools.py", line 139, in evaluate_classification
    for X, y, Z in tq:
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1203, in _next_data
    return self._process_data(data)
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1229, in _process_data
    data.reraise()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 218, in __next__
    i = self.indices[self.cursor]
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 32, in fetch
    data.append(next(self.dataset_iter))
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 236, in __next__
    self.table, self.indices = self.prefetch.result()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/_base.py", line 444, in result
    return self.__get_result()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 131, in _load_next
    table = _read_files(filelist, data_config.load_branches, load_range, treename=data_config.treename)
  File "/m100/home/userexternal/mmalucch/weaver/utils/data/fileio.py", line 87, in _read_files
    if len(table[branches[0]]) == 0:
KeyError: 'pfcand_charge'

