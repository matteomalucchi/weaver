(weaver) [mmalucch@r249n07 weaver]$ python train.py --data-train $WORK/$USER/output_127.root  --data-test $WORK/$USER/output_127.root  --data-config data/AK4/ak4_points_pf_sv_CHS_eta4p7.yaml  --network-config networks/particle_net_pf_sv.py  --model-prefix models_3/  --gpus 0,1,2,3 --batch-size 512 --start-lr 5e-3 --num-epochs 3 --optimizer ranger  --log logs/train3_chs_127.log
[2022-11-30 14:23:04,839] INFO: args:
 - ('regression_mode', False)
 - ('data_config', 'data/AK4/ak4_points_pf_sv_CHS_eta4p7.yaml')
 - ('data_train', ['/m100_work/INF22_lhc_0/mmalucch/output_127.root'])
 - ('data_val', [])
 - ('data_test', ['/m100_work/INF22_lhc_0/mmalucch/output_127.root'])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', False)
 - ('fetch_step', 0.01)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', None)
 - ('tensorboard_custom_fn', None)
 - ('network_config', 'networks/particle_net_pf_sv.py')
 - ('network_option', [])
 - ('model_prefix', 'models_3/')
 - ('load_model_weights', None)
 - ('num_epochs', 3)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 512)
 - ('use_amp', False)
 - ('gpus', '0,1,2,3')
 - ('predict_gpus', '0,1,2,3')
 - ('num_workers', 1)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', 'logs/train3_chs_127.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('local_rank', None)
[2022-11-30 14:23:04,839] INFO: Running in classification mode
[2022-11-30 14:23:05,441] INFO: Using 1 files for training, range: (0, 0.8)
[2022-11-30 14:23:05,441] INFO: Using 1 files for validation, range: (0.8, 1)
[2022-11-30 14:23:05,441] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 14:23:05,668] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 14:23:05,668] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 14:23:05,668] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 14:23:05,668] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 14:23:05,668] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 14:23:05,669] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 14:23:05,669] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 14:23:05,669] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 14:23:05,669] INFO: label_names: ('_label_',)
[2022-11-30 14:23:05,669] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 14:23:05,670] INFO: monitor_variables: ()
[2022-11-30 14:23:05,670] INFO: reweight_method: flat
[2022-11-30 14:23:05,670] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 14:23:05,670] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 14:23:05,670] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 14:23:05,670] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 14:23:05,670] INFO: reweight_threshold: 15
[2022-11-30 14:23:05,670] INFO: reweight_discard_under_overflow: True
[2022-11-30 14:23:05,870] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 14:23:05,870] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 14:23:05,870] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 14:23:05,870] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 14:23:05,870] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 14:23:05,870] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 14:23:05,870] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 14:23:05,871] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 14:23:05,871] INFO: label_names: ('_label_',)
[2022-11-30 14:23:05,871] INFO: observer_names: ()
[2022-11-30 14:23:05,871] INFO: monitor_variables: ()
[2022-11-30 14:23:05,871] INFO: reweight_method: flat
[2022-11-30 14:23:05,871] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 14:23:05,871] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 14:23:05,871] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 14:23:05,871] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 14:23:05,871] INFO: reweight_threshold: 15
[2022-11-30 14:23:05,871] INFO: reweight_discard_under_overflow: True
[2022-11-30 14:23:05,873] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 14:23:06,071] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 14:23:06,071] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 14:23:06,071] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 14:23:06,072] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 14:23:06,072] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 14:23:06,072] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 14:23:06,072] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 14:23:06,072] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 14:23:06,072] INFO: label_names: ('_label_',)
[2022-11-30 14:23:06,072] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 14:23:06,072] INFO: monitor_variables: ()
[2022-11-30 14:23:06,072] INFO: reweight_method: flat
[2022-11-30 14:23:06,073] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 14:23:06,073] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 14:23:06,073] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 14:23:06,073] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 14:23:06,073] INFO: reweight_threshold: 15
[2022-11-30 14:23:06,073] INFO: reweight_discard_under_overflow: True
[2022-11-30 14:23:06,273] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 14:23:06,273] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 14:23:06,273] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 14:23:06,273] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 14:23:06,273] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 14:23:06,273] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 14:23:06,273] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 14:23:06,274] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 14:23:06,274] INFO: label_names: ('_label_',)
[2022-11-30 14:23:06,274] INFO: observer_names: ()
[2022-11-30 14:23:06,274] INFO: monitor_variables: ()
[2022-11-30 14:23:06,274] INFO: reweight_method: flat
[2022-11-30 14:23:06,274] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 14:23:06,274] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 14:23:06,274] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 14:23:06,274] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 14:23:06,275] INFO: reweight_threshold: 15
[2022-11-30 14:23:06,275] INFO: reweight_discard_under_overflow: True
[2022-11-30 14:23:06,278] INFO: Network options: {}
[2022-11-30 14:23:06,401] INFO: Warning: module FeatureConv is treated as a zero-op.
[2022-11-30 14:23:06,402] INFO: Warning: module EdgeConvBlock is treated as a zero-op.
[2022-11-30 14:23:06,402] INFO: Warning: module Dropout is treated as a zero-op.
[2022-11-30 14:23:06,402] INFO: Warning: module ParticleNet is treated as a zero-op.
[2022-11-30 14:23:06,403] INFO: Warning: module ParticleNetTagger is treated as a zero-op.
[2022-11-30 14:23:07,349] INFO: ParticleNetTagger(
  |0.579 M, 100.000% Params, 242.737 MMac, 100.000% MACs|
  (pf_conv): FeatureConv(
    |0.001 M, 0.128% Params, 38.8 KMac, 0.016% MACs|
    (conv): Sequential(
      |0.001 M, 0.128% Params, 38.8 KMac, 0.016% MACs|
      (0): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 2.0 KMac, 0.001% MACs|)
      (1): Conv1d(20, 32, kernel_size=(1,), stride=(1,), bias=False, |0.001 M, 0.110% Params, 32.0 KMac, 0.013% MACs|)
      (2): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.011% Params, 3.2 KMac, 0.001% MACs|)
      (3): ReLU(|0.0 M, 0.000% Params, 1.6 KMac, 0.001% MACs|)
    )
  )
  (sv_conv): FeatureConv(
    |0.0 M, 0.076% Params, 2.35 KMac, 0.001% MACs|
    (conv): Sequential(
      |0.0 M, 0.076% Params, 2.35 KMac, 0.001% MACs|
      (0): BatchNorm1d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.004% Params, 110.0 Mac, 0.000% MACs|)
      (1): Conv1d(11, 32, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.061% Params, 1.76 KMac, 0.001% MACs|)
      (2): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.011% Params, 320.0 Mac, 0.000% MACs|)
      (3): ReLU(|0.0 M, 0.000% Params, 160.0 Mac, 0.000% MACs|)
    )
  )
  (pn): ParticleNet(
    |0.578 M, 99.796% Params, 242.696 MMac, 99.983% MACs|
    (edge_convs): ModuleList(
      |0.305 M, 52.593% Params, 233.07 MMac, 96.017% MACs|
      (0): EdgeConvBlock(
        |0.015 M, 2.563% Params, 11.444 MMac, 4.714% MACs|
        (convs): ModuleList(
          |0.012 M, 2.121% Params, 10.813 MMac, 4.455% MACs|
          (0): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
          (1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
          (2): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 0.707% Params, 3.604 MMac, 1.485% MACs|)
        )
        (bns): ModuleList(
          |0.0 M, 0.066% Params, 337.92 KMac, 0.139% MACs|
          (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
          (2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 112.64 KMac, 0.046% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 168.96 KMac, 0.070% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 56.32 KMac, 0.023% MACs|)
        )
        (sc): Conv1d(32, 64, kernel_size=(1,), stride=(1,), bias=False, |0.002 M, 0.354% Params, 112.64 KMac, 0.046% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.022% Params, 7.04 KMac, 0.003% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.52 KMac, 0.001% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 10.077% Params, 44.739 MMac, 18.431% MACs|
        (convs): ModuleList(
          |0.049 M, 8.486% Params, 43.254 MMac, 17.819% MACs|
          (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
          (1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
          (2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 2.829% Params, 14.418 MMac, 5.940% MACs|)
        )
        (bns): ModuleList(
          |0.001 M, 0.133% Params, 675.84 KMac, 0.278% MACs|
          (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
          (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
          (2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 225.28 KMac, 0.093% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 337.92 KMac, 0.139% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 112.64 KMac, 0.046% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 1.414% Params, 450.56 KMac, 0.186% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.044% Params, 14.08 KMac, 0.006% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 7.04 KMac, 0.003% MACs|)
      )
      (2): EdgeConvBlock(
        |0.231 M, 39.953% Params, 176.887 MMac, 72.872% MACs|
        (convs): ModuleList(
          |0.197 M, 33.943% Params, 173.015 MMac, 71.277% MACs|
          (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
          (1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
          (2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.066 M, 11.314% Params, 57.672 MMac, 23.759% MACs|)
        )
        (bns): ModuleList(
          |0.002 M, 0.265% Params, 1.352 MMac, 0.557% MACs|
          (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
          (2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 450.56 KMac, 0.186% MACs|)
        )
        (acts): ModuleList(
          |0.0 M, 0.000% Params, 675.84 KMac, 0.278% MACs|
          (0): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
          (1): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
          (2): ReLU(|0.0 M, 0.000% Params, 225.28 KMac, 0.093% MACs|)
        )
        (sc): Conv1d(128, 256, kernel_size=(1,), stride=(1,), bias=False, |0.033 M, 5.657% Params, 1.802 MMac, 0.742% MACs|)
        (sc_bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.088% Params, 28.16 KMac, 0.012% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 14.08 KMac, 0.006% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.173 M, 29.832% Params, 9.525 MMac, 3.924% MACs|
      (0): Conv1d(448, 384, kernel_size=(1,), stride=(1,), bias=False, |0.172 M, 29.700% Params, 9.462 MMac, 3.898% MACs|)
      (1): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.001 M, 0.133% Params, 42.24 KMac, 0.017% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 21.12 KMac, 0.009% MACs|)
    )
    (fc): Sequential(
      |0.101 M, 17.370% Params, 100.872 KMac, 0.042% MACs|
      (0): Sequential(
        |0.099 M, 17.015% Params, 98.816 KMac, 0.041% MACs|
        (0): Linear(in_features=384, out_features=256, bias=True, |0.099 M, 17.015% Params, 98.56 KMac, 0.041% MACs|)
        (1): ReLU(|0.0 M, 0.000% Params, 256.0 Mac, 0.000% MACs|)
        (2): Dropout(p=0.1, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
      (1): Linear(in_features=256, out_features=8, bias=True, |0.002 M, 0.355% Params, 2.056 KMac, 0.001% MACs|)
    )
  )
)
[2022-11-30 14:23:07,352] INFO: Computational complexity:       242.74 MMac
[2022-11-30 14:23:07,352] INFO: Number of parameters:           579.24 k
[2022-11-30 14:23:07,352] INFO: Using loss function CrossEntropyLoss() with options {}
[2022-11-30 14:23:08,913] INFO: Optimizer options: {}
[2022-11-30 14:23:08,917] INFO: --------------------------------------------------
[2022-11-30 14:23:08,918] INFO: Epoch #0 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=2420929585 ===
[2022-11-30 14:23:08,945] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
224it [01:10,  3.19it/s, lr=5.00e-03, Loss=0.91982, AvgLoss=1.12414, Acc=0.66797, AvgAcc=0.60628]
[2022-11-30 14:24:19,095] INFO: Processed 114688 entries in total (avg. speed 1634.3 entries/s)
[2022-11-30 14:24:19,095] INFO: Train AvgLoss: 1.12414, AvgAcc: 0.60628
[2022-11-30 14:24:19,095] INFO: Train class distribution: 
    [(0, 34456), (1, 366), (2, 5944), (3, 493), (4, 22509), (5, 16735), (6, 30102), (7, 4083)]
[2022-11-30 14:24:19,136] INFO: Epoch #0 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=480603398 ===
[2022-11-30 14:24:19,167] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
56it [00:15,  3.71it/s, Loss=0.93367, AvgLoss=0.96558, Acc=0.67969, AvgAcc=0.66703]
[2022-11-30 14:24:34,232] INFO: Processed 28672 entries in total (avg. speed 1899.5 entries/s)
[2022-11-30 14:24:34,232] INFO: Evaluation class distribution: 
    [(0, 8672), (1, 82), (2, 1627), (3, 116), (4, 5679), (5, 4046), (6, 7479), (7, 971)]
[2022-11-30 14:24:34,541] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.7977400823402517
    - roc_auc_score_matrix: 
[[0.         0.50971305 0.811364   0.77965945 0.94133687 0.9175054
  0.99039966 0.93351316]
 [0.         0.         0.8403166  0.74264085 0.94161415 0.8635117
  0.9810412  0.9231117 ]
 [0.         0.         0.         0.637168   0.76287794 0.77049506
  0.9790254  0.91024274]
 [0.         0.         0.         0.         0.84962744 0.76316965
  0.99153256 0.9089456 ]
 [0.         0.         0.         0.         0.         0.76172185
  0.9622963  0.92738795]
 [0.         0.         0.         0.         0.         0.
  0.89866346 0.90436953]
 [0.         0.         0.         0.         0.         0.
  0.         0.9836861 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[0.88630074 0.         0.         0.         0.03701568 0.03367159
  0.03517066 0.00784133]
 [0.96341463 0.         0.         0.         0.01219512 0.
  0.02439024 0.        ]
 [0.55132145 0.         0.         0.         0.24277812 0.12476951
  0.07068224 0.01044868]
 [0.68103448 0.         0.         0.         0.13793103 0.15517241
  0.01724138 0.00862069]
 [0.1933439  0.         0.         0.         0.55802078 0.11604156
  0.11551329 0.01708047]
 [0.27928819 0.         0.         0.         0.22565497 0.24270885
  0.2347998  0.0175482 ]
 [0.04893702 0.         0.         0.         0.02567188 0.00120337
  0.92111245 0.00307528]
 [0.32028836 0.         0.         0.         0.09989701 0.07621009
  0.09268795 0.41091658]]
[2022-11-30 14:24:34,589] INFO: Epoch #0: Current validation metric: 0.66703 (best: 0.66703)
[2022-11-30 14:24:34,589] INFO: --------------------------------------------------
[2022-11-30 14:24:34,590] INFO: Epoch #1 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=2375455694 ===
[2022-11-30 14:24:34,613] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
223it [00:58,  3.79it/s, lr=5.00e-03, Loss=0.95567, AvgLoss=0.94537, Acc=0.68359, AvgAcc=0.66919]
[2022-11-30 14:25:33,423] INFO: Processed 114176 entries in total (avg. speed 1940.7 entries/s)
[2022-11-30 14:25:33,424] INFO: Train AvgLoss: 0.94537, AvgAcc: 0.66919
[2022-11-30 14:25:33,424] INFO: Train class distribution: 
    [(0, 34258), (1, 403), (2, 5799), (3, 497), (4, 22596), (5, 16389), (6, 30104), (7, 4130)]
[2022-11-30 14:25:33,520] INFO: Epoch #1 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=1209626030 ===
[2022-11-30 14:25:33,542] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
55it [00:14,  3.76it/s, Loss=1.00849, AvgLoss=0.94190, Acc=0.66992, AvgAcc=0.66836]
[2022-11-30 14:25:48,151] INFO: Processed 28160 entries in total (avg. speed 1924.8 entries/s)
[2022-11-30 14:25:48,151] INFO: Evaluation class distribution: 
    [(0, 8391), (1, 103), (2, 1524), (3, 140), (4, 5535), (5, 4084), (6, 7358), (7, 1025)]
[2022-11-30 14:25:48,453] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.8268182126871031
    - roc_auc_score_matrix: 
[[0.         0.66413385 0.81301767 0.7973475  0.942745   0.9285844
  0.9909683  0.94165665]
 [0.         0.         0.9148064  0.8325936  0.9689627  0.9326022
  0.98985445 0.95419365]
 [0.         0.         0.         0.6956599  0.76709545 0.7952685
  0.9787899  0.90946096]
 [0.         0.         0.         0.         0.86647564 0.8162638
  0.99240184 0.93229264]
 [0.         0.         0.         0.         0.         0.78081954
  0.9647277  0.9253608 ]
 [0.         0.         0.         0.         0.         0.
  0.9026653  0.9075896 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.98568815]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[8.19211059e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.13812418e-01 2.71719700e-02 3.09855798e-02 8.81897271e-03]
 [8.93203883e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.94174757e-02 6.79611650e-02 1.94174757e-02 0.00000000e+00]
 [3.87795276e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  4.68503937e-01 4.98687664e-02 7.80839895e-02 1.57480315e-02]
 [5.14285714e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  3.92857143e-01 7.85714286e-02 1.42857143e-02 0.00000000e+00]
 [9.26829268e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  7.54832882e-01 3.79403794e-02 1.05149051e-01 9.39476061e-03]
 [1.71645446e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  4.20666014e-01 1.57933399e-01 2.33839373e-01 1.59157689e-02]
 [3.41125306e-02 0.00000000e+00 0.00000000e+00 0.00000000e+00
  4.59363958e-02 1.35906496e-04 9.15058440e-01 4.75672737e-03]
 [2.87804878e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  2.07804878e-01 4.19512195e-02 8.09756098e-02 3.81463415e-01]]
[2022-11-30 14:25:48,502] INFO: Epoch #1: Current validation metric: 0.66836 (best: 0.66836)
[2022-11-30 14:25:48,502] INFO: --------------------------------------------------
[2022-11-30 14:25:48,502] INFO: Epoch #2 training
0it [00:00, ?it/s]=== Restarting DataIter train_worker0, seed=3805065825 ===
[2022-11-30 14:25:48,525] INFO: Restarted DataIter train_worker0, load_range=(0.0, 0.8), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
224it [00:57,  3.89it/s, lr=5.00e-05, Loss=0.91735, AvgLoss=0.90314, Acc=0.68555, AvgAcc=0.68255]
[2022-11-30 14:26:46,110] INFO: Processed 114688 entries in total (avg. speed 1990.9 entries/s)
[2022-11-30 14:26:46,110] INFO: Train AvgLoss: 0.90314, AvgAcc: 0.68255
[2022-11-30 14:26:46,110] INFO: Train class distribution: 
    [(0, 34370), (1, 376), (2, 5850), (3, 432), (4, 22603), (5, 16745), (6, 30193), (7, 4119)]
[2022-11-30 14:26:46,169] INFO: Epoch #2 validating
0it [00:00, ?it/s]=== Restarting DataIter val_worker0, seed=1696748459 ===
[2022-11-30 14:26:46,192] INFO: Restarted DataIter val_worker0, load_range=(0.8, 1.0), file_list:
{
  "_": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
56it [00:14,  3.86it/s, Loss=0.82680, AvgLoss=0.91096, Acc=0.71484, AvgAcc=0.68182]
[2022-11-30 14:27:00,691] INFO: Processed 28672 entries in total (avg. speed 1974.3 entries/s)
[2022-11-30 14:27:00,692] INFO: Evaluation class distribution: 
    [(0, 8678), (1, 110), (2, 1553), (3, 126), (4, 5692), (5, 4116), (6, 7371), (7, 1026)]
[2022-11-30 14:27:00,996] INFO: Evaluation metrics: 
    - roc_auc_score: 
0.8296465379515153
    - roc_auc_score_matrix: 
[[0.         0.6550944  0.8350043  0.7773113  0.9455769  0.9283488
  0.99187255 0.9397105 ]
 [0.         0.         0.8940174  0.7876623  0.96470004 0.93239903
  0.98886544 0.9429204 ]
 [0.         0.         0.         0.6904864  0.7636006  0.78939015
  0.9837572  0.91593266]
 [0.         0.         0.         0.         0.8803974  0.7961613
  0.9951849  0.9291748 ]
 [0.         0.         0.         0.         0.         0.7821087
  0.966563   0.9274733 ]
 [0.         0.         0.         0.         0.         0.
  0.90453404 0.9160031 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.98703706]
 [0.         0.         0.         0.         0.         0.
  0.         0.        ]]
    - confusion_matrix: 
[[0.8699009  0.         0.         0.         0.05980641 0.03353307
  0.02339249 0.01336714]
 [0.93636364 0.         0.         0.         0.00909091 0.00909091
  0.02727273 0.01818182]
 [0.46168706 0.         0.         0.         0.35737283 0.11397296
  0.05602061 0.01094656]
 [0.6031746  0.         0.         0.         0.19047619 0.1984127
  0.00793651 0.        ]
 [0.13615601 0.         0.         0.         0.64757554 0.09153197
  0.10470836 0.02002811]
 [0.21793003 0.         0.         0.         0.27065112 0.25340136
  0.23833819 0.0196793 ]
 [0.03975037 0.         0.         0.         0.03174603 0.00094967
  0.92266992 0.004884  ]
 [0.29824561 0.         0.         0.         0.11793372 0.05555556
  0.07017544 0.45808967]]
[2022-11-30 14:27:01,043] INFO: Epoch #2: Current validation metric: 0.68182 (best: 0.68182)
[2022-11-30 14:27:01,043] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 14:27:01,242] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 14:27:01,242] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 14:27:01,242] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 14:27:01,242] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 14:27:01,242] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 14:27:01,243] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 14:27:01,243] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 14:27:01,243] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 14:27:01,243] INFO: label_names: ('_label_',)
[2022-11-30 14:27:01,243] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 14:27:01,243] INFO: monitor_variables: ()
[2022-11-30 14:27:01,243] INFO: reweight_method: flat
[2022-11-30 14:27:01,243] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 14:27:01,244] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 14:27:01,244] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 14:27:01,244] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 14:27:01,244] INFO: reweight_threshold: 15
[2022-11-30 14:27:01,244] INFO: reweight_discard_under_overflow: True
[2022-11-30 14:27:01,248] INFO: Loading model models_3/_best_epoch_state.pt for eval
[2022-11-30 14:27:01,270] INFO: Running on test file group  with 1 files:
.../m100_work/INF22_lhc_0/mmalucch/output_127.root
[2022-11-30 14:27:01,270] INFO: Found file data/AK4/ak4_points_pf_sv_CHS_eta4p7.c04e5d3cf3f35fc3246861d11b758459.auto.yaml w/ auto-generated preprocessing information, will use that instead!
[2022-11-30 14:27:01,469] INFO: preprocess config: {'method': 'manual', 'data_fraction': None, 'params': None}
[2022-11-30 14:27:01,469] INFO: selection: (np.abs(jet_eta)<4.7) & (jet_pt>15) & (jet_pt<1000) & (event_no%7!=0) & ( (jet_hadronFlavour>0) | ((jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)!=4) & (np.abs(jet_partonFlavour)!=5)) ) & ( ~((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)) | ((jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0) & (jet_pt<186)) ) & ( (jet_genjet_pt>0) | ((jet_genjet_pt<=0) & (jet_pt<61)) )
[2022-11-30 14:27:01,469] INFO: test_time_selection: (np.abs(jet_eta)<4.7) & (jet_corr_pt>10) & (jet_corr_pt<1000)
[2022-11-30 14:27:01,469] INFO: var_funcs:
 - ('pfcand_mask', 'awkward.JaggedArray.ones_like(pfcand_etarel)')
 - ('sv_mask', 'awkward.JaggedArray.ones_like(sv_etarel)')
 - ('label_b', '(jet_genjet_pt>0) & (jet_nBHadrons==1)')
 - ('label_bb', '(jet_genjet_pt>0) & (jet_nBHadrons>1)')
 - ('label_c', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons==1)')
 - ('label_cc', '(jet_genjet_pt>0) & (jet_nBHadrons==0) & (jet_nCHadrons>1)')
 - ('label_uds', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (np.abs(jet_partonFlavour)>0) & (np.abs(jet_partonFlavour)<4)')
 - ('label_g', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==21)')
 - ('label_undef', '(jet_genjet_pt>0) & (jet_hadronFlavour==0) & (jet_partonFlavour==0)')
 - ('label_pu', '(jet_genjet_pt<=0)')
 - ('label_catB', '(jet_genjet_pt>0) & (jet_hadronFlavour==5)')
 - ('label_catC', '(jet_genjet_pt>0) & (jet_hadronFlavour==4)')
 - ('_label_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).argmax(1)')
 - ('_labelcheck_', 'np.stack([label_b,label_bb,label_c,label_cc,label_uds,label_g,label_undef,label_pu], axis=1).sum(1)')
[2022-11-30 14:27:01,469] INFO: input_names: ('pf_points', 'pf_features', 'pf_mask', 'sv_points', 'sv_features', 'sv_mask')
[2022-11-30 14:27:01,470] INFO: input_dicts:
 - ('pf_points', ['pfcand_etarel', 'pfcand_phirel'])
 - ('pf_features', ['pfcand_pt_log_nopuppi', 'pfcand_e_log_nopuppi', 'pfcand_etarel', 'pfcand_phirel', 'pfcand_abseta', 'pfcand_charge', 'pfcand_VTX_ass', 'pfcand_lostInnerHits', 'pfcand_normchi2', 'pfcand_quality', 'pfcand_dz', 'pfcand_dzsig', 'pfcand_dxy', 'pfcand_dxysig', 'pfcand_btagEtaRel', 'pfcand_btagPtRatio', 'pfcand_btagPParRatio', 'pfcand_btagSip3dVal', 'pfcand_btagSip3dSig', 'pfcand_btagJetDistVal'])
 - ('pf_mask', ['pfcand_mask'])
 - ('sv_points', ['sv_etarel', 'sv_phirel'])
 - ('sv_features', ['sv_pt_log', 'sv_mass', 'sv_etarel', 'sv_phirel', 'sv_abseta', 'sv_ntracks', 'sv_normchi2', 'sv_dxy', 'sv_dxysig', 'sv_d3d', 'sv_d3dsig'])
 - ('sv_mask', ['sv_mask'])
[2022-11-30 14:27:01,470] INFO: input_shapes:
 - ('pf_points', (-1, 2, 50))
 - ('pf_features', (-1, 20, 50))
 - ('pf_mask', (-1, 1, 50))
 - ('sv_points', (-1, 2, 5))
 - ('sv_features', (-1, 11, 5))
 - ('sv_mask', (-1, 1, 5))
[2022-11-30 14:27:01,470] INFO: preprocess_params:
 - ('pfcand_etarel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_phirel', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_pt_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_e_log_nopuppi', {'length': 50, 'pad_mode': 'constant', 'center': 1.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_abseta', {'length': 50, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_charge', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_VTX_ass', {'length': 50, 'pad_mode': 'constant', 'center': 4, 'scale': 0.3, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_lostInnerHits', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_normchi2', {'length': 50, 'pad_mode': 'constant', 'center': 5, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_quality', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dz', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 150, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dzsig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxy', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 270, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_dxysig', {'length': 50, 'pad_mode': 'constant', 'center': 1.1, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagEtaRel', {'length': 50, 'pad_mode': 'constant', 'center': 2.1, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPtRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagPParRatio', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 90, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagSip3dSig', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_btagJetDistVal', {'length': 50, 'pad_mode': 'constant', 'center': 0, 'scale': 50, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pfcand_mask', {'length': 50, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_etarel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_phirel', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_pt_log', {'length': 5, 'pad_mode': 'constant', 'center': 2.8, 'scale': 0.8, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mass', {'length': 5, 'pad_mode': 'constant', 'center': 1.1, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_abseta', {'length': 5, 'pad_mode': 'constant', 'center': 0.8, 'scale': 1.2, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_ntracks', {'length': 5, 'pad_mode': 'constant', 'center': 3, 'scale': 0.5, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_normchi2', {'length': 5, 'pad_mode': 'constant', 'center': 0.7, 'scale': 0.7, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxy', {'length': 5, 'pad_mode': 'constant', 'center': 0.2, 'scale': 0.6, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_dxysig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3d', {'length': 5, 'pad_mode': 'constant', 'center': 0.35, 'scale': 0.4, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_d3dsig', {'length': 5, 'pad_mode': 'constant', 'center': 5, 'scale': 0.03, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('sv_mask', {'length': 5, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
[2022-11-30 14:27:01,470] INFO: label_names: ('_label_',)
[2022-11-30 14:27:01,470] INFO: observer_names: ('event_no', 'jet_no', 'jet_corr_pt', 'jet_pt', 'jet_eta', 'jet_phi', 'jet_hadronFlavour', 'jet_partonFlavour', 'jet_nBHadrons', 'jet_nCHadrons', 'jet_genjet_pt', 'jet_matched_genjet_pt', 'jet_matched_genjet_eta', 'jet_matched_genjet_phi', 'jet_matched_genjet_deltaR', 'npfcands', 'pfDeepFlavourJetTags_probb', 'pfDeepFlavourJetTags_probbb', 'pfDeepFlavourJetTags_problepb', 'pfDeepFlavourJetTags_probc', 'pfDeepFlavourJetTags_probuds', 'pfDeepFlavourJetTags_probg', 'jet_qgl', 'jet_puId')
[2022-11-30 14:27:01,470] INFO: monitor_variables: ()
[2022-11-30 14:27:01,470] INFO: reweight_method: flat
[2022-11-30 14:27:01,470] INFO: reweight_branches: ('jet_pt', 'jet_eta')
[2022-11-30 14:27:01,471] INFO: reweight_bins: ([15, 20, 26, 35, 46, 61, 80, 106, 141, 186, 247, 326, 432, 571, 756, 1000], [-4.7, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.7])
[2022-11-30 14:27:01,471] INFO: reweight_classes: ('label_catB', 'label_catC', 'label_uds', 'label_g', 'label_undef', 'label_pu')
[2022-11-30 14:27:01,471] INFO: class_weights: [1, 1, 2.5, 5, 0.15, 1]
[2022-11-30 14:27:01,471] INFO: reweight_threshold: 15
[2022-11-30 14:27:01,471] INFO: reweight_discard_under_overflow: True
0it [00:00, ?it/s]=== Restarting DataIter test__worker0, seed=757917700 ===
[2022-11-30 14:27:01,498] INFO: Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/m100_work/INF22_lhc_0/mmalucch/output_127.root"
  ]
}
[2022-11-30 14:27:01,692] ERROR: When reading file /m100_work/INF22_lhc_0/mmalucch/output_127.root:
[2022-11-30 14:27:01,693] ERROR: Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 414, in get
    return self._branchlookup[name]
KeyError: b'jet_matched_genjet_pt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/weaver/utils/data/fileio.py", line 76, in _read_files
    a = _read_root(filepath, branches, load_range=load_range, treename=kwargs.get('treename', None))
  File "/m100/home/userexternal/mmalucch/weaver/utils/data/fileio.py", line 45, in _read_root
    outputs = tree.arrays(branches, namedecode='utf-8', entrystart=start, entrystop=stop)
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 537, in arrays
    branches = list(self._normalize_branches(branches, awkward0))
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 892, in _normalize_branches
    branch = self.get(word, aliases=aliases)
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 416, in get
    return self._get(name, recursive, filtername, filtertitle, aliases)
  File "/m100/home/userexternal/mmalucch/.local/lib/python3.8/site-packages/uproot3/tree.py", line 409, in _get
    raise uproot3.rootio._KeyError("not found: {0}\n in file: {1}".format(repr(name), self._context.sourcepath))
_KeyError: not found: b'jet_matched_genjet_pt'
 in file: /m100_work/INF22_lhc_0/mmalucch/output_127.root

0it [00:00, ?it/s]
Traceback (most recent call last):
  File "train.py", line 889, in <module>
    main(args)
  File "train.py", line 821, in main
    test_metric, scores, labels, observers = evaluate(
  File "/m100/home/userexternal/mmalucch/weaver/utils/nn/tools.py", line 139, in evaluate_classification
    for X, y, Z in tq:
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1203, in _next_data
    return self._process_data(data)
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1229, in _process_data
    data.reraise()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 218, in __next__
    i = self.indices[self.cursor]
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 32, in fetch
    data.append(next(self.dataset_iter))
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 236, in __next__
    self.table, self.indices = self.prefetch.result()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/_base.py", line 444, in result
    return self.__get_result()
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/cineca/prod/opt/libraries/cineca-ai/2.2.0/none/cineca-ai-conda-env-py3.8-cuda-openmpi-11.0/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/m100/home/userexternal/mmalucch/weaver/utils/dataset.py", line 131, in _load_next
    table = _read_files(filelist, data_config.load_branches, load_range, treename=data_config.treename)
  File "/m100/home/userexternal/mmalucch/weaver/utils/data/fileio.py", line 87, in _read_files
    if len(table[branches[0]]) == 0:
KeyError: 'sv_normchi2'

